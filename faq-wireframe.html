<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Help Center - The Farmer's Dog | Wireframe v3</title>
    <!-- Adobe Fonts - Neue Haas Grotesk -->
    <link rel="stylesheet" href="https://use.typekit.net/otc4rpl.css">
    <style>
        /* TFD Design Tokens - Embedded for standalone viewing */
        :root {
            /* TFD Typography */
            --font-family-display: 'neue-haas-grotesk-display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            --font-family-text: 'neue-haas-grotesk-text', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            /* Kale (Primary Brand Green) */
            --kale-0: #E5EFE7;
            --kale-1: #b5d3ba;
            --kale-2: #417c67;
            --kale-3: #173b33;
            /* Carrot (CTA Orange) */
            --carrot-0: #fff4f1;
            --carrot-1: #ffd9cc;
            --carrot-2: #f2674b;
            --carrot-3: #D2563D;
            /* Blueberry */
            --blueberry-0: #e6ecf5;
            --blueberry-1: #b7c6e6;
            --blueberry-2: #385a9d;
            --blueberry-3: #03184e;
            /* Charcoal (Text Grays) */
            --charcoal-0: #39383c;
            --charcoal-1: #717377;
            --charcoal-2: #969799;
            --charcoal-3: #c2c3c5;
            /* Oyster (Light Grays/Backgrounds) */
            --oyster-0: #c6bfb7;
            --oyster-1: #dbd6d1;
            --oyster-2: #efedea;
            --oyster-3: #f6f5f3;
            /* Chickpea (Warm Cream/Tan) */
            --chickpea-0: #d3bfa2;
            --chickpea-1: #f2e1c8;
            --chickpea-2: #fff3e1;
            --chickpea-3: #fffaf3;
            /* Utility Colors */
            --white: #ffffff;
            --gold: #f5a623;
            --success: #2ecc71;
            /* Spacing */
            --spacing-12: 12px;
            --spacing-24: 24px;
            --spacing-36: 36px;
            --spacing-48: 48px;
            /* Border Radius */
            --radius-xs: 2px;
            --radius-sm: 4px;
            --radius-md: 6px;
            --radius-lg: 20px;
            --radius-full: 9999px;
            /* Shadows */
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.1);
            /* Font Weights */
            --font-weight-medium: 500;
            --font-weight-semibold: 600;
            --font-weight-bold: 700;
            /* Z-index */
            --z-dropdown: 100;
            --z-fixed: 1000;
            --z-modal-backdrop: 1001;
            --z-modal: 1002;
            /* Animation */
            --animation-standard: 300ms ease-in-out;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family-text);
            line-height: 1.6;
            color: var(--charcoal-0);
            background: var(--chickpea-3);
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: var(--font-family-display);
        }

        /* Navigation */
        .nav-tfd {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: var(--white);
            padding: 12px 24px;
            z-index: var(--z-fixed);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .nav-tfd__logo {
            color: var(--kale-3);
            font-weight: var(--font-weight-bold);
            font-size: 1.25rem;
            text-decoration: none;
        }

        .nav-tfd__logo-full { display: inline; }
        .nav-tfd__logo-short { display: none; }

        .nav-tfd__links {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .nav-tfd__links a {
            color: var(--charcoal-1);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: var(--font-weight-medium);
            transition: color 0.2s;
        }

        .nav-tfd__links a:hover {
            color: var(--kale-3);
        }

        .nav-tfd__links a.active {
            color: var(--kale-3);
        }

        .nav-tfd__actions {
            display: flex;
            gap: 0.75rem;
            align-items: center;
        }

        .nav-tfd__login {
            color: var(--kale-3);
            text-decoration: none;
            font-weight: var(--font-weight-medium);
            font-size: 0.9rem;
            padding: 8px 16px;
            border: 1px solid var(--oyster-1);
            border-radius: var(--radius-sm);
            transition: all 0.2s;
        }

        .nav-tfd__login:hover {
            border-color: var(--kale-2);
            background: var(--kale-0);
        }

        .nav-tfd__cta {
            background: var(--carrot-2);
            color: var(--white);
            padding: 8px 20px;
            border-radius: var(--radius-sm);
            text-decoration: none;
            font-weight: var(--font-weight-semibold);
            font-size: 0.9rem;
            transition: background 0.2s;
        }

        .nav-tfd__cta:hover {
            background: var(--carrot-3);
        }

        /* Mobile Menu */
        .nav-tfd__mobile-toggle {
            display: none;
            background: none;
            border: none;
            color: var(--kale-3);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.25rem;
        }

        .nav-mobile-menu {
            display: none;
            position: fixed;
            top: 58px;
            left: 0;
            right: 0;
            background: var(--white);
            padding: 1rem;
            border-top: 1px solid var(--oyster-2);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            z-index: 999;
        }

        .nav-mobile-menu.open {
            display: block;
        }

        .nav-mobile-menu a {
            display: block;
            color: var(--charcoal-1);
            text-decoration: none;
            padding: 0.75rem 1rem;
            font-size: 1rem;
            border-radius: var(--radius-sm);
            transition: background 0.2s;
        }

        .nav-mobile-menu a:hover {
            background: var(--oyster-3);
        }

        .nav-mobile-menu a.active {
            color: var(--kale-3);
            background: var(--kale-0);
        }

        .nav-mobile-actions {
            display: flex;
            gap: 0.75rem;
            padding: 1rem;
            border-top: 1px solid var(--oyster-2);
            margin-top: 0.5rem;
        }

        .nav-mobile-actions .nav-tfd__login {
            flex: 1;
            text-align: center;
        }

        .nav-mobile-actions .nav-tfd__cta {
            flex: 1;
            text-align: center;
        }

        @media (max-width: 900px) {
            .nav-tfd__links {
                display: none;
            }
            .nav-tfd__login {
                display: none;
            }
            .nav-tfd__mobile-toggle {
                display: block;
            }
            .nav-tfd {
                padding: 12px 16px;
            }
            .nav-tfd__logo-full {
                display: none;
            }
            .nav-tfd__logo-short {
                display: inline;
            }
        }

        /* ============================================
           PERSONALIZATION PANEL (Demo Only)
           ============================================ */
        .personalization-panel {
            position: fixed;
            top: 70px;
            left: 12px;
            width: 280px;
            background: white;
            border-radius: 8px;
            padding: 1rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            z-index: 999;
            font-size: 0.85rem;
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid var(--oyster-1);
            cursor: pointer;
        }

        .panel-title {
            font-weight: var(--font-weight-semibold);
            color: var(--charcoal-0);
            font-size: 0.9rem;
        }

        .panel-version-tag {
            display: inline-block;
            background: var(--blueberry-2);
            color: white;
            font-size: 0.6rem;
            font-weight: 700;
            padding: 2px 6px;
            border-radius: 3px;
            margin-left: 6px;
            vertical-align: middle;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .panel-toggle-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--oyster-2);
            border: none;
            font-size: 0.85rem;
            cursor: pointer;
            transition: transform 0.3s, background 0.2s;
        }

        .panel-toggle-btn:hover {
            background: var(--oyster-1);
        }

        .personalization-panel.collapsed .panel-toggle-btn {
            transform: rotate(180deg);
        }

        .personalization-panel.collapsed .panel-content {
            max-height: 0;
            margin-top: 0;
            overflow: hidden;
        }

        .personalization-panel.collapsed .panel-header {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .panel-content {
            max-height: 500px;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }

        .panel-section {
            margin-bottom: 1rem;
        }

        .panel-section:last-of-type {
            margin-bottom: 0;
        }

        .panel-label {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--charcoal-0);
            margin-bottom: 8px;
            display: block;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .toggle-group {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .toggle-btn {
            padding: 6px 10px;
            border-radius: 4px;
            border: 1px solid var(--oyster-1);
            background: white;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
            font-family: var(--font-family-text);
        }

        .toggle-btn:hover {
            border-color: var(--blueberry-2);
        }

        .toggle-btn.active {
            background: var(--blueberry-2);
            color: white;
            border-color: var(--blueberry-2);
        }

        .panel-note {
            font-size: 0.7rem;
            color: var(--charcoal-1);
            margin-top: 1rem;
            padding-top: 0.75rem;
            border-top: 1px solid var(--oyster-1);
            line-height: 1.5;
        }

        /* Mobile: Bottom drawer behavior */
        @media (max-width: 768px) {
            .personalization-panel {
                position: fixed;
                top: auto;
                bottom: 0;
                left: 0;
                right: 0;
                width: 100%;
                border-radius: 16px 16px 0 0;
                padding: 0.75rem 1rem 1rem;
                box-shadow: 0 -4px 20px rgba(0,0,0,0.15);
                max-height: 70vh;
                overflow-y: auto;
            }

            .panel-header {
                margin-bottom: 0;
                padding-bottom: 0;
                border-bottom: none;
            }

            .panel-toggle-btn {
                width: 28px;
                height: 28px;
                font-size: 1rem;
            }

            .panel-content {
                margin-top: 0.75rem;
                padding-top: 0.75rem;
                border-top: 1px solid var(--oyster-1);
            }

            .panel-note {
                display: none;
            }
        }

        /* ============================================
           FULL-PAGE CHAT LAYOUT
           ============================================ */
        .faq-page {
            display: flex;
            height: calc(100vh - 58px);
            margin-top: 58px;
            overflow: hidden;
        }

        /* Main chat area - full width dark green */
        .faq-main {
            flex: 1;
            width: 100%;
            background: var(--kale-3);
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden;
        }

        /* Scrollable conversation area */
        .faq-scroll-area {
            flex: 1;
            overflow-y: auto;
            padding: 3rem 2rem 2rem;
            min-height: 0; /* Important for flex overflow */
        }

        /* Conversation container */
        .faq-conversation {
            width: 100%;
            max-width: 700px;
            margin: 0 auto;
            min-height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* Message Thread */
        .faq-thread {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            padding-bottom: 1rem;
        }

        /* Input area - fixed at bottom of main area */
        .faq-input-wrapper {
            background: var(--kale-3);
            padding: 1.5rem 2rem 2rem;
            border-top: 1px solid rgba(255,255,255,0.1);
            flex-shrink: 0; /* Prevent input from shrinking */
        }

        .faq-input-container {
            max-width: 700px;
            margin: 0 auto;
            overflow: visible;
        }

        /* Sidebar - hidden, using pills instead */
        .faq-sidebar {
            display: none;
        }

        /* Question pills - horizontal below input */
        .faq-question-pills {
            display: flex;
            gap: 0.5rem;
            padding: 1rem 0 0;
            flex-wrap: nowrap;
            justify-content: center;
            /* Break out of the 700px container to use full width */
            width: 100vw;
            position: relative;
            left: 50%;
            transform: translateX(-50%);
        }

        .faq-question-pills::-webkit-scrollbar {
            display: none;
        }

        .faq-question-pill {
            flex-shrink: 0;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: var(--radius-full);
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
            color: rgba(255,255,255,0.8);
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .faq-question-pill:hover,
        .faq-question-pill:active {
            background: rgba(255,255,255,0.2);
            border-color: rgba(255,255,255,0.4);
            color: var(--white);
        }

        /* Mobile adjustments */
        @media (max-width: 600px) {
            .faq-question-pills {
                justify-content: flex-start;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                scrollbar-width: none;
                -ms-overflow-style: none;
                padding-left: 2rem;
                padding-right: 2rem;
            }

            .faq-question-pills::-webkit-scrollbar {
                display: none;
            }

            .faq-question-pill:last-child {
                margin-right: 1rem;
            }
        }

        /* Welcome state */
        .faq-welcome {
            text-align: center;
            padding: 2rem 0 3rem;
        }

        .faq-welcome__title {
            font-family: var(--font-family-display);
            font-size: clamp(1.75rem, 4vw, 2.5rem);
            font-weight: var(--font-weight-bold);
            color: var(--white);
            margin-bottom: 0.5rem;
        }

        .faq-welcome__subtitle {
            font-size: 1rem;
            color: rgba(255,255,255,0.6);
        }

        #rotatingTopic {
            color: rgba(255,255,255,0.85);
            font-weight: var(--font-weight-medium);
            transition: opacity 0.3s ease;
        }

        #rotatingTopic.fade-out {
            opacity: 0;
        }

        .faq-welcome__divider {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin: 2rem 0 1.5rem;
            color: rgba(255,255,255,0.4);
            font-size: 0.85rem;
        }

        .faq-welcome__divider::before,
        .faq-welcome__divider::after {
            content: '';
            flex: 1;
            height: 1px;
            background: rgba(255,255,255,0.15);
        }

        .faq-welcome__pills {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            justify-content: center;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Mobile adjustments for main layout */
        @media (max-width: 900px) {
            .faq-main {
                height: calc(100vh - 58px);
            }
        }

        /* User message bubble (right aligned) */
        .faq-message--user {
            align-self: flex-end;
            background: rgba(255,255,255,0.15);
            color: var(--white);
            padding: 1rem 1.25rem;
            border-radius: 20px 20px 4px 20px;
            max-width: 85%;
            font-size: 1rem;
            line-height: 1.5;
            display: none;
        }

        .faq-message--user.visible {
            display: block;
            animation: fadeIn 0.2s ease;
        }

        /* Response message bubble (left aligned) */
        .faq-message--response {
            align-self: flex-start;
            background: var(--kale-0);
            color: var(--charcoal-0);
            padding: 1.25rem 1.5rem;
            border-radius: 20px 20px 20px 4px;
            max-width: 85%;
            font-size: 1rem;
            line-height: 1.7;
            text-align: left;
            display: none;
        }

        .faq-message--response.visible {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .faq-message--response p {
            margin-bottom: 0.75rem;
        }

        .faq-message--response p:last-child {
            margin-bottom: 0;
        }

        .faq-message__cta {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--kale-1);
        }

        .faq-message__cta-link {
            color: var(--kale-2);
            font-weight: var(--font-weight-semibold);
            text-decoration: none;
            font-size: 0.9rem;
        }

        .faq-message__cta-link:hover {
            text-decoration: underline;
        }

        /* ============================================
           INPUT AREA
           ============================================ */
        .faq-input-area {
            width: 100%;
        }

        .faq-input {
            width: 100%;
            background: var(--white);
            border: none;
            border-radius: var(--radius-lg);
            font-family: var(--font-family-text);
            font-size: 1rem;
            color: var(--kale-4);
            padding: 1rem 1.25rem;
            outline: none;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .faq-input::placeholder {
            color: rgba(0,0,0,0.4);
        }

        .faq-input:focus {
            box-shadow: 0 2px 12px rgba(0,0,0,0.15);
            border-color: transparent;
        }

        .faq-input-hint {
            margin-top: 0.75rem;
            font-size: 0.8rem;
            color: rgba(255,255,255,0.4);
            text-align: center;
            transition: opacity 0.3s;
        }

        /* Agent handoff message */
        .faq-message--handoff {
            align-self: flex-start;
            background: rgba(255,255,255,0.1);
            color: rgba(255,255,255,0.85);
            padding: 0.875rem 1.25rem;
            border-radius: 20px 20px 20px 4px;
            max-width: 85%;
            font-size: 0.95rem;
            line-height: 1.5;
            display: none;
            font-style: italic;
        }

        .faq-message--handoff.visible {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        /* Agent message with avatar */
        .faq-message--agent {
            align-self: flex-start;
            display: none;
            gap: 0.75rem;
            max-width: 85%;
        }

        .faq-message--agent.visible {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .faq-agent-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--kale-1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            color: var(--kale-3);
            font-weight: var(--font-weight-bold);
            flex-shrink: 0;
        }

        .faq-agent-bubble {
            background: var(--kale-0);
            color: var(--charcoal-0);
            padding: 1rem 1.25rem;
            border-radius: 20px 20px 20px 4px;
            line-height: 1.6;
        }

        .faq-agent-name {
            font-weight: var(--font-weight-semibold);
            color: var(--kale-3);
            font-size: 0.8rem;
            margin-bottom: 0.25rem;
        }

        /* Follow-up prompt */
        .faq-followup {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--kale-1);
        }

        .faq-followup__question {
            font-size: 0.95rem;
            margin-bottom: 0.75rem;
            color: var(--charcoal-0);
        }

        .faq-followup__options {
            display: flex;
            gap: 0.5rem;
        }

        .faq-followup__btn {
            background: var(--white);
            border: 1px solid var(--kale-1);
            border-radius: var(--radius-full);
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
            color: var(--kale-3);
            cursor: pointer;
            transition: all 0.2s;
            font-family: var(--font-family-text);
        }

        .faq-followup__btn:hover {
            background: var(--kale-1);
            border-color: var(--kale-2);
        }

        .faq-followup__btn--primary {
            background: var(--kale-2);
            border-color: var(--kale-2);
            color: var(--white);
        }

        .faq-followup__btn--primary:hover {
            background: var(--kale-3);
            border-color: var(--kale-3);
        }

        .faq-followup.answered {
            opacity: 0.6;
            pointer-events: none;
        }

        /* Video embed */
        .faq-video-embed {
            margin-top: 0.5rem;
            border-radius: 12px;
            overflow: hidden;
            background: #000;
        }

        .faq-video-embed iframe {
            width: 100%;
            aspect-ratio: 16/9;
            display: block;
            border: none;
        }

        /* Product card */
        .faq-product-card {
            background: var(--white);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .faq-product-card__image {
            background: var(--oyster-2);
            height: 160px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--charcoal-1);
            font-size: 0.9rem;
            font-weight: var(--font-weight-semibold);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .faq-product-card__content {
            padding: 1rem;
        }

        .faq-product-card__title {
            font-family: var(--font-family-display);
            font-size: 1.1rem;
            font-weight: var(--font-weight-bold);
            color: var(--charcoal-0);
            margin-bottom: 0.25rem;
        }

        .faq-product-card__description {
            font-size: 0.9rem;
            color: var(--charcoal-1);
            margin-bottom: 0.75rem;
            line-height: 1.5;
        }

        .faq-product-card__cta {
            display: inline-block;
            background: var(--carrot-2);
            color: var(--white);
            padding: 0.6rem 1.25rem;
            border-radius: var(--radius-sm);
            text-decoration: none;
            font-weight: var(--font-weight-semibold);
            font-size: 0.9rem;
            transition: background 0.2s;
        }

        .faq-product-card__cta:hover {
            background: var(--carrot-3);
        }

        /* Typing indicator */
        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: 0.5rem 0;
        }

        .typing-indicator span {
            width: 8px;
            height: 8px;
            background: var(--kale-2);
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }

        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
            30% { transform: translateY(-4px); opacity: 1; }
        }

        /* Clarification message with options */
        .faq-message--clarify {
            align-self: flex-start;
            background: var(--kale-0);
            color: var(--charcoal-0);
            padding: 1.25rem 1.5rem;
            border-radius: 20px 20px 20px 4px;
            max-width: 85%;
            font-size: 1rem;
            line-height: 1.6;
            text-align: left;
            display: none;
        }

        .faq-message--clarify.visible {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .faq-clarify__question {
            margin-bottom: 1rem;
        }

        .faq-clarify__options {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .faq-clarify__option {
            background: var(--white);
            border: 1px solid var(--kale-1);
            border-radius: 12px;
            padding: 0.75rem 1rem;
            font-size: 0.95rem;
            color: var(--kale-3);
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
        }

        .faq-clarify__option:hover {
            background: var(--kale-1);
            border-color: var(--kale-2);
        }

        /* ============================================
           BROWSE SECTION - Now hidden, replaced by sidebar
           ============================================ */
        .faq-browse {
            display: none;
        }

        .faq-browse__container {
            max-width: 700px;
            margin: 0 auto;
        }

        .faq-browse__header {
            text-align: center;
            margin-bottom: 2.5rem;
        }

        .faq-browse__title {
            font-size: 1.5rem;
            font-weight: var(--font-weight-bold);
            color: var(--kale-3);
            margin-bottom: 0.5rem;
        }

        .faq-browse__subtitle {
            color: var(--charcoal-1);
            font-size: 1rem;
        }

        /* Accordion Styles (kept for reference/mobile) */
        .faq-accordion {
            border: 1px solid var(--oyster-1);
            border-radius: var(--radius-lg);
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .faq-accordion__header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.25rem 1.5rem;
            background: var(--white);
            border: none;
            cursor: pointer;
            text-align: left;
            transition: background 0.2s;
        }

        .faq-accordion__header:hover {
            background: var(--oyster-3);
        }

        .faq-accordion__question {
            font-weight: var(--font-weight-semibold);
            color: var(--charcoal-0);
            font-size: 1rem;
            flex: 1;
            padding-right: 1rem;
        }

        .faq-accordion__icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--kale-2);
            font-size: 1.25rem;
            transition: transform 0.3s;
        }

        .faq-accordion.open .faq-accordion__icon {
            transform: rotate(45deg);
        }

        .faq-accordion__body {
            display: none;
            padding: 0 1.5rem 1.5rem;
            color: var(--charcoal-1);
            line-height: 1.7;
        }

        .faq-accordion.open .faq-accordion__body {
            display: block;
        }

        .faq-accordion__body p {
            margin-bottom: 0.75rem;
        }

        .faq-accordion__body p:last-child {
            margin-bottom: 0;
        }

        /* Category Labels */
        .faq-category {
            font-size: 0.75rem;
            font-weight: var(--font-weight-bold);
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--charcoal-2);
            margin: 2rem 0 1rem;
        }

        .faq-category:first-child {
            margin-top: 0;
        }

        /* ============================================
           OR BROWSE DIVIDER (per PRD 7.1)
           ============================================ */
        .browse-divider {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin: 2.5rem auto;
            max-width: 600px;
        }

        .browse-divider__line {
            flex: 1;
            height: 1px;
            background: var(--oyster-1);
        }

        .browse-divider__text {
            font-size: 0.85rem;
            color: var(--charcoal-2);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: var(--font-weight-medium);
        }

        /* ============================================
           FEATURED QUESTIONS (per PRD 2.4)
           ============================================ */
        .featured-questions {
            max-width: 600px;
            margin: 0 auto 3rem;
        }

        .featured-question {
            display: block;
            width: 100%;
            padding: 1.25rem 1.5rem;
            background: var(--white);
            border: 1px solid var(--oyster-1);
            border-radius: var(--radius-lg);
            margin-bottom: 0.75rem;
            text-align: left;
            cursor: pointer;
            transition: background var(--animation-standard), border-color var(--animation-standard);
            text-decoration: none;
        }

        .featured-question:hover {
            background: var(--kale-0);
            border-color: var(--kale-1);
        }

        .featured-question__text {
            font-weight: var(--font-weight-semibold);
            color: var(--kale-3);
            font-size: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .featured-question__arrow {
            color: var(--kale-2);
            font-size: 1.25rem;
        }

        /* ============================================
           MAIN CONTENT AREA
           ============================================ */
        .faq-content {
            max-width: 700px;
            margin: 0 auto;
            padding: 0 1.5rem 4rem;
        }

        /* ============================================
           INLINE ANSWER CARD (per PRD 7.2)
           ============================================ */
        .answer-card {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: 2rem 2.5rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-lg);
            display: none;
        }

        .answer-card--visible {
            display: block;
        }

        .answer-card__back {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--kale-2);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: var(--font-weight-medium);
            margin-bottom: 1.25rem;
            cursor: pointer;
            background: none;
            border: none;
            padding: 0;
        }

        .answer-card__back:hover {
            text-decoration: underline;
        }

        .answer-card__question {
            font-size: 1.5rem;
            font-weight: var(--font-weight-bold);
            color: var(--kale-3);
            margin-bottom: 1.25rem;
            line-height: 1.3;
        }

        .answer-card__answer {
            color: var(--charcoal-1);
            line-height: 1.8;
            font-size: 1rem;
        }

        .answer-card__answer p {
            margin-bottom: 1rem;
        }

        .answer-card__answer ul {
            margin: 1rem 0;
            padding-left: 1.5rem;
        }

        .answer-card__answer li {
            margin-bottom: 0.5rem;
        }

        .answer-card__answer strong {
            color: var(--charcoal-0);
        }

        /* Dynamic blocks within answers */
        .answer-block {
            background: var(--oyster-3);
            border-radius: var(--radius-md);
            padding: 1.25rem;
            margin: 1.5rem 0;
        }

        .answer-block--stat {
            border-left: 3px solid var(--success);
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .answer-block--review {
            border-left: 3px solid var(--gold);
        }

        .answer-block--expert {
            border-left: 3px solid var(--blueberry-2);
            display: flex;
            gap: 1rem;
        }

        .answer-block__stat-number {
            font-size: 2rem;
            font-weight: var(--font-weight-bold);
            color: var(--success);
            line-height: 1;
        }

        .answer-block__stat-text {
            font-size: 0.9rem;
            color: var(--charcoal-1);
        }

        .answer-block__review-text {
            font-style: italic;
            color: var(--charcoal-0);
            margin-bottom: 0.5rem;
        }

        .answer-block__review-author {
            font-size: 0.85rem;
            color: var(--charcoal-1);
        }

        .answer-block__expert-photo {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--oyster-2);
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.6rem;
            color: var(--charcoal-1);
        }

        .answer-block__expert-quote {
            font-style: italic;
            color: var(--charcoal-0);
            margin-bottom: 0.35rem;
        }

        .answer-block__expert-name {
            font-size: 0.85rem;
            font-weight: var(--font-weight-semibold);
            color: var(--charcoal-0);
        }

        /* CTA within answer */
        .answer-card__cta {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--oyster-1);
        }

        .answer-card__cta-button {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: var(--carrot-2);
            color: white;
            padding: 0.875rem 1.5rem;
            border-radius: var(--radius-sm);
            text-decoration: none;
            font-weight: var(--font-weight-bold);
            font-size: 0.95rem;
            transition: background var(--animation-standard);
        }

        .answer-card__cta-button:hover {
            background: var(--carrot-3);
        }

        /* ============================================
           "WAS THIS HELPFUL?" (per PRD 5.3)
           ============================================ */
        .helpful-prompt {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--oyster-1);
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .helpful-prompt__text {
            font-size: 0.95rem;
            color: var(--charcoal-1);
        }

        .helpful-prompt__buttons {
            display: flex;
            gap: 0.5rem;
        }

        .helpful-btn {
            padding: 0.5rem 1.25rem;
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
            font-weight: var(--font-weight-medium);
            cursor: pointer;
            transition: all var(--animation-standard);
            border: 1px solid var(--oyster-1);
            background: var(--white);
            color: var(--charcoal-0);
        }

        .helpful-btn:hover {
            border-color: var(--kale-2);
            color: var(--kale-2);
        }

        .helpful-btn--yes:hover {
            background: var(--kale-0);
            border-color: var(--kale-2);
            color: var(--kale-3);
        }

        .helpful-btn--no:hover {
            background: var(--carrot-0);
            border-color: var(--carrot-2);
            color: var(--carrot-3);
        }

        /* ============================================
           CLARIFICATION CARD (per PRD 2.2)
           ============================================ */
        .clarification-card {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: 2rem 2.5rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-lg);
            display: none;
        }

        .clarification-card--visible {
            display: block;
        }

        .clarification-card__back {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--kale-2);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: var(--font-weight-medium);
            margin-bottom: 1.25rem;
            cursor: pointer;
            background: none;
            border: none;
            padding: 0;
        }

        .clarification-card__back:hover {
            text-decoration: underline;
        }

        .clarification-card__title {
            font-size: 1.25rem;
            font-weight: var(--font-weight-bold);
            color: var(--kale-3);
            margin-bottom: 1.25rem;
        }

        .clarification-card__options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .clarification-option {
            display: block;
            width: 100%;
            padding: 1rem 1.25rem;
            background: var(--oyster-3);
            border: 1px solid var(--oyster-1);
            border-radius: var(--radius-md);
            text-align: left;
            cursor: pointer;
            transition: all var(--animation-standard);
            font-size: 0.95rem;
            color: var(--charcoal-0);
        }

        .clarification-option:hover {
            background: var(--kale-0);
            border-color: var(--kale-1);
            color: var(--kale-3);
        }

        /* ============================================
           CHAT ESCALATION PANEL (per PRD 5.1, 7.3)
           ============================================ */
        .chat-panel {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: 2rem 2.5rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-lg);
            display: none;
        }

        .chat-panel--visible {
            display: block;
        }

        .chat-panel__back {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--kale-2);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: var(--font-weight-medium);
            margin-bottom: 1.25rem;
            cursor: pointer;
            background: none;
            border: none;
            padding: 0;
        }

        .chat-panel__back:hover {
            text-decoration: underline;
        }

        .chat-panel__title {
            font-size: 1.25rem;
            font-weight: var(--font-weight-bold);
            color: var(--kale-3);
            margin-bottom: 0.5rem;
        }

        .chat-panel__subtitle {
            font-size: 0.95rem;
            color: var(--charcoal-1);
            margin-bottom: 1.5rem;
        }

        .chat-panel__message-preview {
            background: var(--oyster-3);
            border-radius: var(--radius-md);
            padding: 1rem 1.25rem;
            margin-bottom: 1.5rem;
            border-left: 3px solid var(--kale-2);
        }

        .chat-panel__message-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--charcoal-2);
            margin-bottom: 0.35rem;
        }

        .chat-panel__message-text {
            color: var(--charcoal-0);
            font-style: italic;
        }

        .chat-panel__options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .chat-panel__btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 1rem 1.5rem;
            border-radius: var(--radius-sm);
            font-weight: var(--font-weight-semibold);
            font-size: 0.95rem;
            cursor: pointer;
            transition: all var(--animation-standard);
            text-decoration: none;
        }

        .chat-panel__btn--primary {
            background: var(--carrot-2);
            color: var(--white);
            border: none;
        }

        .chat-panel__btn--primary:hover {
            background: var(--carrot-3);
        }

        .chat-panel__btn--secondary {
            background: var(--white);
            color: var(--charcoal-0);
            border: 1px solid var(--oyster-1);
        }

        .chat-panel__btn--secondary:hover {
            border-color: var(--kale-2);
            color: var(--kale-2);
        }

        /* Email capture within chat panel */
        .chat-panel__email {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--oyster-1);
        }

        .chat-panel__email-label {
            font-size: 0.9rem;
            color: var(--charcoal-1);
            margin-bottom: 0.75rem;
        }

        .chat-panel__email-form {
            display: flex;
            gap: 0.5rem;
        }

        .chat-panel__email-input {
            flex: 1;
            padding: 0.75rem 1rem;
            border: 1px solid var(--oyster-1);
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
        }

        .chat-panel__email-input:focus {
            outline: none;
            border-color: var(--kale-2);
        }

        .chat-panel__email-submit {
            padding: 0.75rem 1.25rem;
            background: var(--kale-2);
            color: var(--white);
            border: none;
            border-radius: var(--radius-sm);
            font-weight: var(--font-weight-semibold);
            cursor: pointer;
        }

        .chat-panel__email-submit:hover {
            background: var(--kale-3);
        }

        .chat-panel__reassurance {
            margin-top: 1.5rem;
            font-size: 0.85rem;
            color: var(--charcoal-2);
            text-align: center;
        }

        /* ============================================
           GLADLY-STYLE FLOATING CHAT WIDGET (per PRD 5.1, 7.3)
           ============================================ */
        .chat-widget-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.3);
            z-index: var(--z-modal-backdrop);
            opacity: 0;
            visibility: hidden;
            transition: opacity var(--animation-standard), visibility var(--animation-standard);
        }

        .chat-widget-overlay--open {
            opacity: 1;
            visibility: visible;
        }

        .chat-widget {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 380px;
            max-width: calc(100vw - 48px);
            max-height: calc(100vh - 120px);
            background: var(--white);
            border-radius: var(--radius-lg);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            z-index: var(--z-modal);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transform: translateY(20px) scale(0.95);
            opacity: 0;
            visibility: hidden;
            transition: transform 0.3s ease, opacity 0.3s ease, visibility 0.3s ease;
        }

        .chat-widget--open {
            transform: translateY(0) scale(1);
            opacity: 1;
            visibility: visible;
        }

        /* Chat Widget Header */
        .chat-widget__header {
            background: var(--kale-3);
            color: var(--white);
            padding: 1rem 1.25rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .chat-widget__header-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .chat-widget__avatar {
            width: 40px;
            height: 40px;
            background: var(--kale-2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .chat-widget__title {
            font-weight: var(--font-weight-bold);
            font-size: 1rem;
        }

        .chat-widget__status {
            font-size: 0.8rem;
            opacity: 0.8;
            display: flex;
            align-items: center;
            gap: 0.35rem;
        }

        .chat-widget__status-dot {
            width: 8px;
            height: 8px;
            background: var(--success);
            border-radius: 50%;
        }

        .chat-widget__close {
            background: none;
            border: none;
            color: var(--white);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.25rem;
            opacity: 0.8;
            transition: opacity 0.2s;
        }

        .chat-widget__close:hover {
            opacity: 1;
        }

        /* Chat Widget Messages */
        .chat-widget__messages {
            flex: 1;
            padding: 1.25rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            min-height: 200px;
            background: var(--oyster-3);
        }

        .chat-message {
            max-width: 85%;
            padding: 0.875rem 1rem;
            border-radius: var(--radius-lg);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .chat-message--user {
            background: var(--kale-3);
            color: var(--white);
            align-self: flex-end;
            border-bottom-right-radius: var(--radius-xs);
        }

        .chat-message--system {
            background: var(--white);
            color: var(--charcoal-1);
            align-self: flex-start;
            border-bottom-left-radius: var(--radius-xs);
            font-size: 0.85rem;
        }

        .chat-message--agent {
            background: var(--white);
            color: var(--charcoal-0);
            align-self: flex-start;
            border-bottom-left-radius: var(--radius-xs);
        }

        /* Email capture in chat */
        .chat-widget__email-capture {
            padding: 1rem 1.25rem;
            background: var(--chickpea-3);
            border-top: 1px solid var(--oyster-1);
        }

        .chat-widget__email-label {
            font-size: 0.8rem;
            color: var(--charcoal-1);
            margin-bottom: 0.5rem;
        }

        .chat-widget__email-form {
            display: flex;
            gap: 0.5rem;
        }

        .chat-widget__email-input {
            flex: 1;
            padding: 0.625rem 0.875rem;
            border: 1px solid var(--oyster-1);
            border-radius: var(--radius-sm);
            font-size: 0.85rem;
            background: var(--white);
        }

        .chat-widget__email-input:focus {
            outline: none;
            border-color: var(--kale-2);
        }

        .chat-widget__email-btn {
            padding: 0.625rem 1rem;
            background: var(--kale-2);
            color: var(--white);
            border: none;
            border-radius: var(--radius-sm);
            font-weight: var(--font-weight-semibold);
            font-size: 0.85rem;
            cursor: pointer;
        }

        .chat-widget__email-btn:hover {
            background: var(--kale-3);
        }

        /* Chat Widget Input */
        .chat-widget__input-area {
            padding: 1rem 1.25rem;
            border-top: 1px solid var(--oyster-1);
            background: var(--white);
        }

        .chat-widget__input-form {
            display: flex;
            gap: 0.5rem;
        }

        .chat-widget__input {
            flex: 1;
            padding: 0.75rem 1rem;
            border: 1px solid var(--oyster-1);
            border-radius: var(--radius-full);
            font-size: 0.9rem;
        }

        .chat-widget__input:focus {
            outline: none;
            border-color: var(--kale-2);
        }

        .chat-widget__input::placeholder {
            color: var(--charcoal-2);
        }

        .chat-widget__send {
            width: 44px;
            height: 44px;
            background: var(--kale-2);
            color: var(--white);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            transition: background 0.2s;
        }

        .chat-widget__send:hover {
            background: var(--kale-3);
        }

        /* No Answer State - Inline card that triggers chat */
        .no-answer-card {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: 3rem 2.5rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-lg);
            text-align: center;
            display: none;
        }

        .no-answer-card--visible {
            display: block;
        }

        .no-answer-card__title {
            font-size: 1.35rem;
            font-weight: var(--font-weight-bold);
            color: var(--kale-3);
            margin-bottom: 0.5rem;
        }

        .no-answer-card__subtitle {
            font-size: 1rem;
            color: var(--charcoal-1);
            margin-bottom: 0.5rem;
        }

        .no-answer-card__connecting {
            font-size: 0.9rem;
            color: var(--charcoal-2);
            font-style: italic;
        }

        @media (max-width: 480px) {
            .chat-widget {
                bottom: 0;
                right: 0;
                width: 100%;
                max-width: 100%;
                max-height: 85vh;
                border-radius: var(--radius-lg) var(--radius-lg) 0 0;
            }
        }

        /* Sensitive Chat Panel - Priority Support styling */
        .sensitive-chat-header {
            margin-bottom: 1rem;
        }

        .sensitive-chat-badge {
            display: inline-block;
            background: var(--carrot-0);
            color: var(--carrot-3);
            padding: 0.35rem 0.75rem;
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: var(--font-weight-bold);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Urgent clarification option styling */
        .clarification-option--urgent {
            background: var(--carrot-0);
            border-color: var(--carrot-1);
        }

        .clarification-option--urgent:hover {
            background: var(--carrot-1);
            border-color: var(--carrot-2);
            color: var(--carrot-3);
        }

        /* ============================================
           FOOTER
           ============================================ */
        .footer {
            background: var(--kale-3);
            color: rgba(255,255,255,0.7);
            padding: 4rem 2rem 2rem;
        }

        .footer-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .footer-top {
            display: grid;
            grid-template-columns: 1.5fr 2fr;
            gap: 4rem;
            padding-bottom: 3rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        @media (max-width: 900px) {
            .footer-top {
                grid-template-columns: 1fr;
                gap: 2.5rem;
            }
        }

        .footer-newsletter {
            max-width: 400px;
        }

        .footer-newsletter__title {
            font-family: var(--font-family-display);
            font-size: 1.5rem;
            font-weight: var(--font-weight-bold);
            color: var(--white);
            margin-bottom: 0.5rem;
        }

        .footer-newsletter__subtitle {
            font-size: 0.95rem;
            color: rgba(255,255,255,0.7);
            margin-bottom: 1.25rem;
            line-height: 1.5;
        }

        .footer-newsletter__form {
            display: flex;
            gap: 0.5rem;
        }

        .footer-newsletter__input {
            flex: 1;
            padding: 0.75rem 1rem;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: var(--radius-sm);
            background: rgba(255,255,255,0.1);
            color: var(--white);
            font-size: 0.9rem;
        }

        .footer-newsletter__input::placeholder {
            color: rgba(255,255,255,0.5);
        }

        .footer-newsletter__input:focus {
            outline: none;
            border-color: var(--carrot-2);
            background: rgba(255,255,255,0.15);
        }

        .footer-newsletter__btn {
            background: var(--carrot-2);
            color: var(--white);
            padding: 0.75rem 1.25rem;
            border: none;
            border-radius: var(--radius-sm);
            font-weight: var(--font-weight-semibold);
            font-size: 0.9rem;
            cursor: pointer;
            transition: background 0.2s;
            white-space: nowrap;
        }

        .footer-newsletter__btn:hover {
            background: var(--carrot-3);
        }

        @media (max-width: 480px) {
            .footer-newsletter__form {
                flex-direction: column;
            }
        }

        .footer-links {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2rem;
        }

        @media (max-width: 600px) {
            .footer-links {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 400px) {
            .footer-links {
                grid-template-columns: 1fr;
            }
        }

        .footer-links__group h4 {
            font-family: var(--font-family-display);
            font-size: 0.8rem;
            font-weight: var(--font-weight-semibold);
            color: rgba(255,255,255,0.5);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 1rem;
        }

        .footer-links__group ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .footer-links__group li {
            margin-bottom: 0.6rem;
        }

        .footer-links__group a {
            color: rgba(255,255,255,0.85);
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.2s;
        }

        .footer-links__group a:hover {
            color: var(--white);
        }

        .footer-middle {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 2rem 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            flex-wrap: wrap;
            gap: 1.5rem;
        }

        .footer-social {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .footer-social__link {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255,255,255,0.1);
            color: var(--white);
            text-decoration: none;
            font-size: 1.1rem;
            transition: background 0.2s, transform 0.2s;
        }

        .footer-social__link:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }

        .footer-logo {
            font-family: var(--font-family-display);
            font-size: 1.25rem;
            font-weight: var(--font-weight-bold);
            color: var(--white);
        }

        .footer-bottom {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .footer-copyright {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.5);
        }

        .footer-legal {
            display: flex;
            gap: 1.5rem;
            flex-wrap: wrap;
        }

        .footer-legal a {
            color: rgba(255,255,255,0.5);
            text-decoration: none;
            font-size: 0.85rem;
            transition: color 0.2s;
        }

        .footer-legal a:hover {
            color: rgba(255,255,255,0.85);
        }

        @media (max-width: 600px) {
            .footer-bottom {
                flex-direction: column;
                text-align: center;
            }

            .footer-legal {
                justify-content: center;
            }
        }

        /* State: Hide featured questions when answer is shown */
        .hero--has-answer .featured-questions,
        .hero--has-answer .browse-divider {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="nav-tfd">
        <a href="index.html" class="nav-tfd__logo"><span class="nav-tfd__logo-full">The Farmer's Dog</span><span class="nav-tfd__logo-short">TFD</span></a>
        <div class="nav-tfd__links">
            <a href="our-food-wireframe.html">Our Food</a>
            <a href="our-difference-wireframe.html">Our Difference</a>
            <a href="reviews-wireframe.html">Reviews</a>
            <a href="faq-wireframe.html" class="active">FAQ</a>
            <a href="about-us-wireframe.html">About Us</a>
            <a href="#">Vet Professionals</a>
        </div>
        <div class="nav-tfd__actions">
            <a href="#" class="nav-tfd__login">Log In</a>
            <a href="get-started-wireframe.html" class="nav-tfd__cta">Get Started  50% Off</a>
        </div>
        <button class="nav-tfd__mobile-toggle" onclick="toggleMobileMenu()"></button>
    </nav>

    <!-- Mobile Menu -->
    <div class="nav-mobile-menu" id="mobileMenu">
        <a href="our-food-wireframe.html">Our Food</a>
        <a href="our-difference-wireframe.html">Our Difference</a>
        <a href="reviews-wireframe.html">Reviews</a>
        <a href="faq-wireframe.html" class="active">FAQ</a>
        <a href="about-us-wireframe.html">About Us</a>
        <a href="#">Vet Professionals</a>
        <div class="nav-mobile-actions">
            <a href="#" class="nav-tfd__login">Log In</a>
            <a href="get-started-wireframe.html" class="nav-tfd__cta">Get Started  50% Off</a>
        </div>
    </div>

    <!-- Personalization Panel (Wireframe Demo Only) -->
    <div class="personalization-panel" id="personalizationPanel">
        <div class="panel-header" onclick="togglePanel()">
            <span class="panel-title">Personalization Demo <span class="panel-version-tag">v1</span></span>
            <button class="panel-toggle-btn" aria-label="Toggle panel">&#9650;</button>
        </div>

        <div class="panel-content">
            <div class="panel-section">
                <span class="panel-label">Account Status</span>
                <div class="toggle-group" id="accountToggle">
                    <button class="toggle-btn active" data-account="default" onclick="setAccountStatus('default')">No account</button>
                    <button class="toggle-btn" data-account="payment-failed" onclick="setAccountStatus('payment-failed')">Payment failed</button>
                    <button class="toggle-btn" data-account="recent-pause" onclick="setAccountStatus('recent-pause')">Recent pause</button>
                    <button class="toggle-btn" data-account="new-customer" onclick="setAccountStatus('new-customer')">New customer</button>
                </div>
            </div>

            <div class="panel-section">
                <span class="panel-label">Page Visited</span>
                <div class="toggle-group" id="pageToggle">
                    <button class="toggle-btn active" data-page="default" onclick="setPageVisited('default')">Homepage</button>
                    <button class="toggle-btn" data-page="plan" onclick="setPageVisited('plan')">Plan page</button>
                    <button class="toggle-btn" data-page="get-started" onclick="setPageVisited('get-started')">Get Started</button>
                </div>
            </div>

            <p class="panel-note">
                Simulates personalized FAQ experience based on user account status and browsing context.
            </p>
        </div>
    </div>

    <!-- ============================================
         FULL PAGE CHAT LAYOUT
         ============================================ -->
    <div class="faq-page">
        <!-- Main Chat Area -->
        <div class="faq-main">
            <!-- Scrollable conversation area -->
            <div class="faq-scroll-area" id="scrollArea">
                <div class="faq-conversation">
                    <!-- Welcome message (shows before any conversation) -->
                    <div class="faq-welcome" id="faqWelcome">
                        <h1 class="faq-welcome__title">How can we help?</h1>
                        <p class="faq-welcome__subtitle">Just ask your question or topic below  even keywords like "<span id="rotatingTopic">delivery</span>" work great</p>

                        <div class="faq-welcome__divider">
                            <span>or select a question</span>
                        </div>

                        <!-- Question pills in welcome area -->
                        <div class="faq-welcome__pills" id="welcomePills">
                            <button class="faq-question-pill" onclick="askSidebarQuestion('I\'m new to fresh food  what should I know?')">I'm new to fresh food</button>
                            <button class="faq-question-pill" onclick="askSidebarQuestion('Is fresh dog food worth the cost?')">Is this worth the cost?</button>
                            <button class="faq-question-pill" onclick="askSidebarQuestion('What\'s actually in the food?')">What's actually in it?</button>
                            <button class="faq-question-pill" onclick="askSidebarQuestion('How does delivery work?')">How does delivery work?</button>
                            <button class="faq-question-pill" onclick="askSidebarQuestion('My dog has allergies  can you help?')">My dog has allergies</button>
                        </div>
                    </div>

                    <!-- Message Thread -->
                    <div class="faq-thread" id="faqThread">
                        <!-- Messages will be dynamically added here -->
                    </div>
                </div>
            </div>

            <!-- Input Area - fixed at bottom -->
            <div class="faq-input-wrapper">
                <div class="faq-input-container">
                    <form id="faqSearchForm" onsubmit="handleConversationalSearch(event)">
                        <input
                            type="text"
                            class="faq-input"
                            id="faqInput"
                            placeholder="Type your question..."
                            autocomplete="off"
                        >
                    </form>
                    <p class="faq-input-hint" id="inputHint">Press Enter to ask</p>
                </div>
            </div>
        </div>

    </div>

    <!-- ============================================
         MAIN CONTENT - Answer Cards, Clarifications, Chat Panel
         ============================================ -->
    <main class="faq-content" style="display: none;">

        <!-- ============================================
             INLINE ANSWER CARD - "Why should I feed fresh?" (per PRD 7.2)
             ============================================ -->
        <div class="answer-card" id="answer-fresh-food">
            <button class="answer-card__back" onclick="backToSearch()"> Back to search</button>
            <h2 class="answer-card__question">Why should I feed fresh?</h2>
            <div class="answer-card__answer">
                <p>Fresh food is minimally processed, which means more nutrients remain intact and bioavailable for your dog to absorb. Kibble is cooked at extremely high temperatures (often over 400F), which destroys many nutrients that then have to be added back synthetically.</p>

                <div class="answer-block answer-block--expert">
                    <div class="answer-block__expert-photo">[Photo]</div>
                    <div>
                        <p class="answer-block__expert-quote">"The difference between processed and fresh food isn't marketing. It's bioavailability. Dogs absorb more nutrients from real food."</p>
                        <p class="answer-block__expert-name">Dr. Joseph Wakshlag, DVM, Ph.D.</p>
                    </div>
                </div>

                <p>A peer-reviewed study conducted with Cornell University found that dogs fed fresh food showed improved markers of long-term health within just one month of switching.</p>

                <div class="answer-block answer-block--stat">
                    <div class="answer-block__stat-number">93%</div>
                    <div class="answer-block__stat-text">of customers see visible health improvements within weeks</div>
                </div>
            </div>

            <div class="answer-card__cta">
                <a href="get-started-wireframe.html" class="answer-card__cta-button">See your dog's plan  50% Off</a>
            </div>

            <!-- "Was this helpful?" (per PRD 5.3) -->
            <div class="helpful-prompt">
                <span class="helpful-prompt__text">Was this helpful?</span>
                <div class="helpful-prompt__buttons">
                    <button class="helpful-btn helpful-btn--yes" onclick="handleHelpful(true, 'fresh-food')">Yes</button>
                    <button class="helpful-btn helpful-btn--no" onclick="handleHelpful(false, 'fresh-food')">No</button>
                </div>
            </div>
        </div>

        <!-- ============================================
             INLINE ANSWER CARD - "What are the recipes and ingredients?"
             ============================================ -->
        <div class="answer-card" id="answer-recipes">
            <button class="answer-card__back" onclick="backToSearch()"> Back to search</button>
            <h2 class="answer-card__question">What are the recipes and ingredients?</h2>
            <div class="answer-card__answer">
                <p>We offer four complete and balanced recipes, each made with human-grade ingredients:</p>
                <ul>
                    <li><strong>Beef:</strong> USDA beef, sweet potato, lentils, carrots, spinach</li>
                    <li><strong>Chicken:</strong> USDA chicken, parsnips, spinach, carrots, green beans</li>
                    <li><strong>Turkey:</strong> USDA turkey, chickpeas, carrots, broccoli, parsley</li>
                    <li><strong>Pork:</strong> USDA pork, sweet potato, green beans, cauliflower, spinach</li>
                </ul>

                <p>Every recipe is formulated by board-certified veterinary nutritionists to meet AAFCO standards for all life stages.</p>

                <div class="answer-block answer-block--review">
                    <p class="answer-block__review-text">"I love that I can actually see and recognize every ingredient. No mystery powders or chemicals."</p>
                    <p class="answer-block__review-author"> Sarah M., Cooper's mom</p>
                </div>
            </div>

            <div class="answer-card__cta">
                <a href="get-started-wireframe.html" class="answer-card__cta-button">Build your dog's plan  50% Off</a>
            </div>

            <div class="helpful-prompt">
                <span class="helpful-prompt__text">Was this helpful?</span>
                <div class="helpful-prompt__buttons">
                    <button class="helpful-btn helpful-btn--yes" onclick="handleHelpful(true, 'recipes')">Yes</button>
                    <button class="helpful-btn helpful-btn--no" onclick="handleHelpful(false, 'recipes')">No</button>
                </div>
            </div>
        </div>

        <!-- ============================================
             INLINE ANSWER CARD - "How do shipments work?"
             ============================================ -->
        <div class="answer-card" id="answer-shipping">
            <button class="answer-card__back" onclick="backToSearch()"> Back to search</button>
            <h2 class="answer-card__question">How do shipments work?</h2>
            <div class="answer-card__answer">
                <p>We ship your dog's personalized meals directly to your door on a schedule tailored to their eating plantypically every 2-4 weeks.</p>

                <ul>
                    <li><strong>Free shipping</strong> on every order, always</li>
                    <li><strong>Eco-friendly packaging</strong> with dry ice to keep food frozen</li>
                    <li><strong>Flexible scheduling</strong>  adjust, skip, or pause anytime</li>
                    <li><strong>Tracking</strong> provided for every shipment</li>
                </ul>

                <div class="answer-block answer-block--stat">
                    <div class="answer-block__stat-number">Free</div>
                    <div class="answer-block__stat-text">shipping on every order, always</div>
                </div>

                <p>We ship nationwide to all 48 contiguous states. Most orders arrive within 1-5 business days depending on your location.</p>
            </div>

            <div class="answer-card__cta">
                <a href="get-started-wireframe.html" class="answer-card__cta-button">Get started  50% Off</a>
            </div>

            <div class="helpful-prompt">
                <span class="helpful-prompt__text">Was this helpful?</span>
                <div class="helpful-prompt__buttons">
                    <button class="helpful-btn helpful-btn--yes" onclick="handleHelpful(true, 'shipping')">Yes</button>
                    <button class="helpful-btn helpful-btn--no" onclick="handleHelpful(false, 'shipping')">No</button>
                </div>
            </div>
        </div>

        <!-- ============================================
             INLINE ANSWER CARD - "Life stages"
             ============================================ -->
        <div class="answer-card" id="answer-life-stages">
            <button class="answer-card__back" onclick="backToSearch()"> Back to search</button>
            <h2 class="answer-card__question">Do you have food for puppies, adults, and seniors?</h2>
            <div class="answer-card__answer">
                <p>Yes! All of our recipes are formulated to meet AAFCO nutritional standards for <strong>all life stages</strong>, including:</p>

                <ul>
                    <li><strong>Puppies:</strong> Complete nutrition for growth and development</li>
                    <li><strong>Adult dogs:</strong> Balanced meals for maintenance and vitality</li>
                    <li><strong>Seniors:</strong> Easy-to-digest nutrition with joint-supporting benefits</li>
                </ul>

                <p>When you create your plan, we ask about your dog's age and life stage to calculate the perfect portion size. As your dog grows or ages, you can update their profile and we'll adjust automatically.</p>

                <div class="answer-block answer-block--review">
                    <p class="answer-block__review-text">"Started my puppy on TFD at 12 weeks. Now he's 3 and still loves every meal. Never had to switch foods!"</p>
                    <p class="answer-block__review-author"> Marcus T., Benny's dad</p>
                </div>
            </div>

            <div class="answer-card__cta">
                <a href="get-started-wireframe.html" class="answer-card__cta-button">Build your dog's plan  50% Off</a>
            </div>

            <div class="helpful-prompt">
                <span class="helpful-prompt__text">Was this helpful?</span>
                <div class="helpful-prompt__buttons">
                    <button class="helpful-btn helpful-btn--yes" onclick="handleHelpful(true, 'life-stages')">Yes</button>
                    <button class="helpful-btn helpful-btn--no" onclick="handleHelpful(false, 'life-stages')">No</button>
                </div>
            </div>
        </div>

        <!-- ============================================
             INLINE ANSWER CARD - "Cost / Price" (Searchable but not featured per PRD 3.3)
             ============================================ -->
        <div class="answer-card" id="answer-cost">
            <button class="answer-card__back" onclick="backToSearch()"> Back to search</button>
            <h2 class="answer-card__question">What does The Farmer's Dog cost?</h2>
            <div class="answer-card__answer">
                <p>The cost depends on your dog's size, age, and activity level. Every plan is personalized, so pricing variesbut most customers pay between <strong>$2-12 per day</strong>.</p>

                <div class="answer-block answer-block--stat">
                    <div class="answer-block__stat-number">50%</div>
                    <div class="answer-block__stat-text">off your first box when you try The Farmer's Dog</div>
                </div>

                <p>Many customers find that when they factor in vet bills, treats, and supplements they no longer need, fresh food is comparable to what they were spending beforewith better results.</p>

                <p>The best way to see your exact price is to complete the quick quiz. It takes about 2 minutes.</p>
            </div>

            <div class="answer-card__cta">
                <a href="get-started-wireframe.html" class="answer-card__cta-button">Get your dog's exact price  50% Off</a>
            </div>

            <div class="helpful-prompt">
                <span class="helpful-prompt__text">Was this helpful?</span>
                <div class="helpful-prompt__buttons">
                    <button class="helpful-btn helpful-btn--yes" onclick="handleHelpful(true, 'cost')">Yes</button>
                    <button class="helpful-btn helpful-btn--no" onclick="handleHelpful(false, 'cost')">No</button>
                </div>
            </div>
        </div>

        <!-- ============================================
             CLARIFICATION CARD - Ambiguous "shipping" query (per PRD 2.2, 4.3)
             ============================================ -->
        <div class="clarification-card" id="clarification-shipping">
            <button class="clarification-card__back" onclick="backToSearch()"> Back to search</button>
            <h3 class="clarification-card__title">Are you asking about...</h3>
            <div class="clarification-card__options">
                <button class="clarification-option" onclick="showAnswer('shipping')">Delivery times and schedule</button>
                <button class="clarification-option" onclick="showAnswer('shipping-cost')">Shipping costs</button>
                <button class="clarification-option" onclick="showAnswer('shipping-address')">Changing your delivery address</button>
            </div>
        </div>

        <!-- ============================================
             CLARIFICATION CARD - Ambiguous "cost/price" query
             ============================================ -->
        <div class="clarification-card" id="clarification-cost">
            <button class="clarification-card__back" onclick="backToSearch()"> Back to search</button>
            <h3 class="clarification-card__title">Are you asking about...</h3>
            <div class="clarification-card__options">
                <button class="clarification-option" onclick="showAnswer('cost')">Plan pricing</button>
                <button class="clarification-option" onclick="showAnswer('billing')">Billing and payment</button>
                <button class="clarification-option" onclick="showAnswer('discounts')">Discounts and promotions</button>
            </div>
        </div>

        <!-- ============================================
             SENSITIVE TOPIC CLARIFICATION - Pancreatitis (per PRD 3.6)
             Gated response - must confirm intent before responding
             ============================================ -->
        <div class="clarification-card" id="clarification-pancreatitis">
            <button class="clarification-card__back" onclick="backToSearch()"> Back to search</button>
            <h3 class="clarification-card__title">Are you asking about...</h3>
            <div class="clarification-card__options">
                <button class="clarification-option" onclick="showAnswer('panc-general')">General information about pancreatitis in dogs</button>
                <button class="clarification-option" onclick="showAnswer('panc-suitability')">Whether The Farmer's Dog food is suitable for dogs with pancreatitis</button>
                <button class="clarification-option clarification-option--urgent" onclick="showSensitiveChatPanel('pancreatitis-concern')">A concern about my dog's health after eating your food</button>
            </div>
        </div>

        <!-- ============================================
             SENSITIVE ANSWER - Pancreatitis General Info
             ============================================ -->
        <div class="answer-card" id="answer-panc-general">
            <button class="answer-card__back" onclick="backToSearch()"> Back to search</button>
            <h2 class="answer-card__question">Understanding pancreatitis in dogs</h2>
            <div class="answer-card__answer">
                <p>Pancreatitis is inflammation of the pancreas, which can range from mild to severe. It's often triggered by high-fat foods, but can have other causes including genetics, certain medications, or underlying conditions.</p>

                <p><strong>Common signs include:</strong></p>
                <ul>
                    <li>Vomiting or loss of appetite</li>
                    <li>Abdominal pain (hunched posture)</li>
                    <li>Lethargy or weakness</li>
                    <li>Diarrhea</li>
                    <li>Fever</li>
                </ul>

                <div class="answer-block answer-block--expert">
                    <div class="answer-block__expert-photo">[Photo]</div>
                    <div>
                        <p class="answer-block__expert-quote">"If you suspect pancreatitis, contact your veterinarian immediately. Early intervention is key to successful treatment."</p>
                        <p class="answer-block__expert-name">Dr. Sarah Chen, DVM</p>
                    </div>
                </div>

                <p>If your dog has been diagnosed with or is prone to pancreatitis, consult your veterinarian about dietary management. They can help determine the best approach for your dog's specific situation.</p>
            </div>

            <div class="helpful-prompt">
                <span class="helpful-prompt__text">Was this helpful?</span>
                <div class="helpful-prompt__buttons">
                    <button class="helpful-btn helpful-btn--yes" onclick="handleHelpful(true, 'panc-general')">Yes</button>
                    <button class="helpful-btn helpful-btn--no" onclick="handleHelpful(false, 'panc-general')">No</button>
                </div>
            </div>
        </div>

        <!-- ============================================
             SENSITIVE ANSWER - Pancreatitis Suitability (routes to vet + chat)
             ============================================ -->
        <div class="answer-card" id="answer-panc-suitability">
            <button class="answer-card__back" onclick="backToSearch()"> Back to search</button>
            <h2 class="answer-card__question">Is The Farmer's Dog suitable for dogs with pancreatitis?</h2>
            <div class="answer-card__answer">
                <p>Dogs with pancreatitis or a history of pancreatic issues have unique dietary needs that should be determined by a veterinarian who knows your dog's specific health history.</p>

                <p>Our recipes vary in fat content, and what works for one dog may not work for another. We strongly recommend:</p>

                <ol>
                    <li><strong>Consult your veterinarian first</strong>  They can review our nutritional information and advise whether any of our recipes are appropriate</li>
                    <li><strong>Share our recipe details</strong>  We're happy to provide full nutritional profiles to share with your vet</li>
                    <li><strong>Consider a gradual approach</strong>  If approved by your vet, any diet transition should be slow and monitored</li>
                </ol>

                <div class="answer-block answer-block--expert">
                    <div class="answer-block__expert-photo">[Photo]</div>
                    <div>
                        <p class="answer-block__expert-quote">"Every case of pancreatitis is different. I always recommend working with your vet to determine the right diet for your specific dog."</p>
                        <p class="answer-block__expert-name">Dr. Joseph Wakshlag, DVM, Ph.D.</p>
                    </div>
                </div>
            </div>

            <div class="answer-card__cta">
                <p style="margin-bottom: 1rem; color: var(--charcoal-1); font-size: 0.95rem;">Want to discuss your dog's specific situation?</p>
                <button class="answer-card__cta-button" onclick="showSensitiveChatPanel('panc-diet-help')" style="background: var(--kale-2);"> Chat with our team</button>
            </div>

            <div class="helpful-prompt">
                <span class="helpful-prompt__text">Was this helpful?</span>
                <div class="helpful-prompt__buttons">
                    <button class="helpful-btn helpful-btn--yes" onclick="handleHelpful(true, 'panc-suitability')">Yes</button>
                    <button class="helpful-btn helpful-btn--no" onclick="handleHelpful(false, 'panc-suitability')">No</button>
                </div>
            </div>
        </div>

        <!-- ============================================
             SENSITIVE CHAT PANEL - Immediate escalation for health concerns
             Per PRD 3.6: "Concern about your dog's health"  Immediate chat escalation
             ============================================ -->
        <div class="chat-panel" id="sensitiveChatPanel">
            <button class="chat-panel__back" onclick="backToSearch()"> Back to search</button>

            <div class="sensitive-chat-header">
                <span class="sensitive-chat-badge">Priority Support</span>
            </div>

            <h3 class="chat-panel__title">We're here to help.</h3>
            <p class="chat-panel__subtitle" id="sensitiveChatSubtitle">We take health concerns seriously. Let's connect you with our Customer Experience team right away.</p>

            <div class="chat-panel__message-preview">
                <p class="chat-panel__message-label">Your concern</p>
                <p class="chat-panel__message-text" id="sensitiveChatQueryPreview">"Health concern about my dog"</p>
            </div>

            <div class="chat-panel__options">
                <button class="chat-panel__btn chat-panel__btn--primary"> Chat with us now  We're here</button>
                <a href="tel:6467807957" class="chat-panel__btn chat-panel__btn--secondary"> Call us: 646.780.7957</a>
            </div>

            <div class="chat-panel__email">
                <p class="chat-panel__email-label">Or leave your details and we'll reach out to you:</p>
                <form class="chat-panel__email-form">
                    <input type="email" class="chat-panel__email-input" placeholder="your@email.com">
                    <button type="submit" class="chat-panel__email-submit">Contact me</button>
                </form>
            </div>

            <p class="chat-panel__reassurance">Our team is available 24/7 to help with any concerns.</p>
        </div>

        <!-- ============================================
             HIDDEN ANSWER - "Grass fed / Sourcing" (per PRD 3.4, 4.2)
             ============================================ -->
        <div class="answer-card" id="answer-sourcing">
            <button class="answer-card__back" onclick="backToSearch()"> Back to search</button>
            <h2 class="answer-card__question">Is your meat organic or grass-fed?</h2>
            <div class="answer-card__answer">
                <p>We can't guarantee specific parameters like organic or grass-fed certification for every ingredient in every mealsupply chains today make that difficult to promise consistently.</p>

                <p>What we <strong>can and do guarantee</strong> is that all our meats and vegetables are <strong>human-grade</strong>, which in our view is the most important measure of ingredient quality. This means our ingredients meet the same safety and quality standards as food you'd find in a grocery store.</p>

                <p>If you have specific dietary requirements for your dog, we'd love to hear about them. Let us know below and we'll reach out when we have a recipe that suits your needs.</p>
            </div>

            <!-- Special action: Email capture for recipe notification (per PRD 4.2) -->
            <div class="chat-panel__email">
                <p class="chat-panel__email-label">Get notified when we have recipes that match your requirements:</p>
                <form class="chat-panel__email-form">
                    <input type="email" class="chat-panel__email-input" placeholder="Your email">
                    <button type="submit" class="chat-panel__email-submit">Notify me</button>
                </form>
            </div>

            <div class="helpful-prompt">
                <span class="helpful-prompt__text">Was this helpful?</span>
                <div class="helpful-prompt__buttons">
                    <button class="helpful-btn helpful-btn--yes" onclick="handleHelpful(true, 'sourcing')">Yes</button>
                    <button class="helpful-btn helpful-btn--no" onclick="handleHelpful(false, 'sourcing')">No</button>
                </div>
            </div>
        </div>

        <!-- ============================================
             NO ANSWER CARD - Shows inline when no match (per PRD 2.3)
             Chat widget opens automatically
             ============================================ -->
        <div class="no-answer-card" id="noAnswerCard">
            <h3 class="no-answer-card__title">We don't have that answer ready for you.</h3>
            <p class="no-answer-card__subtitle">Let me connect you with an advisor...</p>
        </div>

    </main>

    <!-- ============================================
         GLADLY-STYLE FLOATING CHAT WIDGET (per PRD 5.1, 7.3)
         Opens automatically when no match found
         User's query appears as ALREADY SENT message
         ============================================ -->
    <div class="chat-widget-overlay" id="chatWidgetOverlay" onclick="closeChatWidget()"></div>
    <div class="chat-widget" id="chatWidget">
        <div class="chat-widget__header">
            <div class="chat-widget__header-info">
                <div class="chat-widget__avatar"></div>
                <div>
                    <div class="chat-widget__title">The Farmer's Dog</div>
                    <div class="chat-widget__status">
                        <span class="chat-widget__status-dot"></span>
                        Support is online
                    </div>
                </div>
            </div>
            <button class="chat-widget__close" onclick="closeChatWidget()"></button>
        </div>

        <div class="chat-widget__messages" id="chatMessages">
            <!-- User's query appears as already-sent message (per PRD 2.3) -->
            <div class="chat-message chat-message--user" id="userQueryMessage">
                fish
            </div>

            <!-- System message -->
            <div class="chat-message chat-message--system">
                Your message has been sent. An agent will respond shortly.
            </div>

            <!-- Agent response -->
            <div class="chat-message chat-message--agent">
                Hi there! Thanks for reaching out. I'm looking into your question now and will have an answer for you in just a moment.
            </div>
        </div>

        <!-- Email capture (per PRD 5.2) -->
        <div class="chat-widget__email-capture">
            <p class="chat-widget__email-label">Leave your email in case we take a moment to respond:</p>
            <form class="chat-widget__email-form" onsubmit="return false;">
                <input type="email" class="chat-widget__email-input" placeholder="your@email.com">
                <button type="submit" class="chat-widget__email-btn">Save</button>
            </form>
        </div>

        <div class="chat-widget__input-area">
            <form class="chat-widget__input-form" onsubmit="return false;">
                <input type="text" class="chat-widget__input" placeholder="Type a message...">
                <button type="submit" class="chat-widget__send"></button>
            </form>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-top">
                <div class="footer-newsletter">
                    <h3 class="footer-newsletter__title">Join the pack</h3>
                    <p class="footer-newsletter__subtitle">Get nutrition tips, exclusive offers, and stories from real dog parents delivered to your inbox.</p>
                    <form class="footer-newsletter__form">
                        <input type="email" class="footer-newsletter__input" placeholder="Enter your email">
                        <button type="submit" class="footer-newsletter__btn">Subscribe</button>
                    </form>
                </div>

                <div class="footer-links">
                    <div class="footer-links__group">
                        <h4>Explore</h4>
                        <ul>
                            <li><a href="#">DIY</a></li>
                            <li><a href="#">Digest</a></li>
                            <li><a href="#">Breeds</a></li>
                            <li><a href="#">WSAVA</a></li>
                            <li><a href="#">Careers</a></li>
                            <li><a href="#">Affiliates</a></li>
                        </ul>
                    </div>

                    <div class="footer-links__group">
                        <h4>Support</h4>
                        <ul>
                            <li><a href="mailto:help@thefarmersdog.com">help@thefarmersdog.com</a></li>
                            <li><a href="tel:6467807957">Call/Text: 646.780.7957</a></li>
                            <li><a href="faq-wireframe.html">Help Center</a></li>
                        </ul>
                    </div>

                    <div class="footer-links__group">
                        <h4>Business</h4>
                        <ul>
                            <li><a href="#">Media Inquiries</a></li>
                            <li><a href="#">Partnership Inquiries</a></li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="footer-middle">
                <div class="footer-social">
                    <a href="#" class="footer-social__link" aria-label="Instagram">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>
                    </a>
                    <a href="#" class="footer-social__link" aria-label="Facebook">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"/></svg>
                    </a>
                    <a href="#" class="footer-social__link" aria-label="TikTok">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z"/></svg>
                    </a>
                </div>
                <div class="footer-logo">The Farmer's Dog</div>
            </div>

            <div class="footer-bottom">
                <p class="footer-copyright"> 2025 The Farmer's Dog, Inc. All rights reserved.</p>
                <div class="footer-legal">
                    <a href="#">Privacy Policy</a>
                    <a href="#">Terms of Service</a>
                    <a href="#">Accessibility</a>
                    <a href="#">Do Not Sell My Personal Information</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Mobile menu toggle
        function toggleMobileMenu() {
            document.getElementById('mobileMenu').classList.toggle('open');
        }

        // Rotating topic suggestions
        const rotatingTopics = [
            'delivery',
            'human-grade',
            'fresh food',
            'portions',
            'subscriptions'
        ];
        let currentTopicIndex = 0;

        function rotateTopics() {
            const topicEl = document.getElementById('rotatingTopic');
            if (!topicEl) return;

            // Fade out
            topicEl.classList.add('fade-out');

            setTimeout(() => {
                // Change topic
                currentTopicIndex = (currentTopicIndex + 1) % rotatingTopics.length;
                topicEl.textContent = rotatingTopics[currentTopicIndex];
                // Fade in
                topicEl.classList.remove('fade-out');
            }, 300);
        }

        // Start rotation every 3 seconds
        setInterval(rotateTopics, 3000);

        // ============================================
        // PERSONALIZATION PANEL LOGIC
        // ============================================

        // Current personalization state
        let currentAccountStatus = 'default';
        let currentPageVisited = 'default';

        // Question sets for different scenarios
        const questionSets = {
            // Account-based questions
            account: {
                'default': [
                    { label: 'I\'m new to fresh food', question: 'I\'m new to fresh food  what should I know?' },
                    { label: 'Is this worth the cost?', question: 'Is fresh dog food worth the cost?' },
                    { label: 'What\'s actually in it?', question: 'What\'s actually in the food?' },
                    { label: 'How does delivery work?', question: 'How does delivery work?' },
                    { label: 'My dog has allergies', question: 'My dog has allergies  can you help?' }
                ],
                'payment-failed': [
                    { label: 'I need to update my card', question: 'I need to update my payment method' },
                    { label: 'Why didn\'t it go through?', question: 'Why didn\'t my payment go through?' },
                    { label: 'Will I miss a delivery?', question: 'Will I miss a delivery because of this?' },
                    { label: 'I need some help', question: 'I need some help with my account' },
                    { label: 'Can I pause instead?', question: 'Can I pause my subscription instead?' }
                ],
                'recent-pause': [
                    { label: 'I\'m ready to start again', question: 'I\'m ready to resume my deliveries' },
                    { label: 'Can I change my schedule?', question: 'Can I change my delivery schedule?' },
                    { label: 'My dog\'s needs changed', question: 'My dog\'s needs have changed  can I update my plan?' },
                    { label: 'What\'s new?', question: 'Anything new since I paused?' },
                    { label: 'Skip vs pause?', question: 'What\'s the difference between skipping and pausing?' }
                ],
                'new-customer': [
                    { label: 'How do I transition?', question: 'How should I transition my dog to fresh food?' },
                    { label: 'How do I store it?', question: 'How do I store the food?' },
                    { label: 'Are the portions right?', question: 'How do I know if the portions are right for my dog?' },
                    { label: 'What\'s in my first box?', question: 'What should I expect in my first box?' },
                    { label: 'Can I mix with kibble?', question: 'Can I mix this with kibble while transitioning?' }
                ]
            },
            // Page-based questions
            page: {
                'default': null, // Will use account questions
                'plan': [
                    { label: 'Can I try a new recipe?', question: 'Can I switch to a different recipe?' },
                    { label: 'Portions seem off', question: 'The portions don\'t seem quite right for my dog' },
                    { label: 'I have another dog', question: 'I have another dog  can I add them?' },
                    { label: 'Change delivery frequency?', question: 'Can I change how often I get deliveries?' },
                    { label: 'Need to pause or cancel', question: 'I need to pause or cancel for a bit' }
                ],
                'get-started': [
                    { label: 'What will it cost?', question: 'What will this cost for my dog?' },
                    { label: 'Is shipping included?', question: 'Is shipping included in the price?' },
                    { label: 'Any commitment?', question: 'Is there any commitment or can I cancel anytime?' },
                    { label: 'What\'s in the first box?', question: 'What comes in the first box?' },
                    { label: 'What if my dog won\'t eat it?', question: 'What if my dog doesn\'t like it?' }
                ]
            }
        };

        // Toggle panel collapse
        function togglePanel() {
            const panel = document.getElementById('personalizationPanel');
            panel.classList.toggle('collapsed');
        }

        // Set account status
        function setAccountStatus(status) {
            currentAccountStatus = status;

            // Update toggle buttons
            document.querySelectorAll('#accountToggle .toggle-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.account === status);
            });

            updateQuestionPills();
        }

        // Set page visited
        function setPageVisited(page) {
            currentPageVisited = page;

            // Update toggle buttons
            document.querySelectorAll('#pageToggle .toggle-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.page === page);
            });

            updateQuestionPills();
        }

        // Update the question pills based on current state
        function updateQuestionPills() {
            const pillsContainer = document.getElementById('welcomePills');

            // Determine which question set to use
            // Page-specific questions take priority if set, otherwise use account-based
            let questions;
            if (currentPageVisited !== 'default' && questionSets.page[currentPageVisited]) {
                questions = questionSets.page[currentPageVisited];
            } else {
                questions = questionSets.account[currentAccountStatus];
            }

            // Clear and rebuild pills
            pillsContainer.innerHTML = questions.map(q =>
                `<button class="faq-question-pill" onclick="askSidebarQuestion('${q.question.replace(/'/g, "\\'")}')">${q.label}</button>`
            ).join('');
        }

        // Conversational Response Database
        const conversationalResponses = {
            'fresh': {
                answer: `<p>Fresh food is minimally processed, which means more nutrients stay intact for your dog to absorb. Kibble is cooked at extreme temperatures (400F+), destroying nutrients that then need to be added back synthetically.</p><p>A peer-reviewed study with Cornell University found dogs eating fresh food showed improved health markers within just one month.</p>`
            },
            'cost': {
                answer: `<p>Plans typically range from $29/day depending on your dog's size and caloric needs. Most medium-sized dogs fall in the $36/day range.</p><p>Many customers find they spend less overall once vet bills for "mystery allergies" and digestive issues decrease.</p>`
            },
            'ingredients': {
                answer: `<p>We use USDA human-grade meat (beef, chicken, turkey, or pork) combined with fresh vegetables like sweet potatoes, carrots, and leafy greens. Every recipe is formulated by board-certified veterinary nutritionists.</p><p>No fillers, no by-products, no artificial preservativesjust real food you can see and recognize.</p>`
            },
            'shipping_how': {
                answer: `<p>We ship directly to your door on a schedule you control. Food arrives frozen with dry ice to keep it fresh. Just transfer to your freezer and thaw as needed.</p><p>Free shipping on all orders, and you can skip, pause, or reschedule anytime from your account.</p>`
            },
            'shipping_issue': {
                answer: `<p>I'm sorry to hear you're having a shipping issue. Let me connect you with someone who can help right away.</p>`,
                escalate: true
            },
            'puppy': {
                answer: `<p>Yes! All our recipes are formulated to meet AAFCO standards for "all life stages"meaning they're complete and balanced for puppies, adults, and seniors.</p><p>We'll calculate the right portions based on your puppy's age, breed, and expected adult weight.</p>`
            },
            'cancel': {
                answer: `<p>Absolutely. No commitments, no contracts. You can pause, skip, or cancel anytime directly from your accountno phone calls required.</p>`
            },
            'panc_info': {
                answer: `<p>Our recipes are formulated for healthy dogs and aren't specifically designed for dogs with pancreatitis. Dogs with this condition often need a carefully managed low-fat diet.</p><p>We'd recommend talking to your vet about whether our food is right for your dog's specific situation.</p>`
            },
            'panc_concern': {
                answer: `<p>I'm really sorry to hear your dog isn't feeling well. Let me connect you with our team right away so we can help.</p>`,
                escalate: true
            },
            'default': {
                answer: `<p>I'm not quite sure what you're looking for. Let me connect you with someone who can help.</p>`,
                escalate: true
            }
        };

        // Clarification questions for ambiguous queries
        const clarifications = {
            'ship': {
                question: "What would you like to know about shipping?",
                options: [
                    { label: "How does shipping work?", response: 'shipping_how' },
                    { label: "I have an issue with my shipment", response: 'shipping_issue' }
                ]
            },
            'panc': {
                question: "I want to make sure I understand  are you asking about:",
                options: [
                    { label: "Is your food okay for dogs with pancreatitis?", response: 'panc_info' },
                    { label: "I think your food made my dog sick", response: 'panc_concern' }
                ]
            },
            'cost': {
                question: "What would you like to know about pricing?",
                options: [
                    { label: "How much does it cost?", response: 'cost' },
                    { label: "I have a billing issue", response: 'billing_issue' }
                ]
            }
        };

        // Add billing issue response
        conversationalResponses['billing_issue'] = {
            answer: `<p>I'm sorry you're experiencing a billing issue. Let me connect you with someone who can look into this for you.</p>`,
            escalate: true
        };

        // Topics that trigger immediate escalation (no clarification needed)
        const immediateEscalation = ['sick', 'ill', 'vomit', 'diarrhea', 'allergic', 'reaction', 'refund', 'complaint', 'problem', 'issue', 'wrong', 'damaged', 'vet said', 'doctor'];

        // State tracking
        let currentQuery = '';

        // Handle conversational search
        function handleConversationalSearch(event) {
            event.preventDefault();
            const input = document.getElementById('faqInput');
            const query = input.value.trim();
            const queryLower = query.toLowerCase();

            if (query.length < 2) return;

            currentQuery = query;
            input.value = '';
            hideWelcome();

            // Create user message in thread
            const thread = document.getElementById('faqThread');
            const userMsg = document.createElement('div');
            userMsg.className = 'faq-message--user visible';
            userMsg.textContent = query;
            thread.appendChild(userMsg);
            scrollToBottom();

            // Check if immediate escalation is needed
            const needsImmediateEscalation = immediateEscalation.some(topic => queryLower.includes(topic));

            if (needsImmediateEscalation) {
                showEscalation(query);
                return;
            }

            // Check if clarification is needed
            for (const [trigger, clarification] of Object.entries(clarifications)) {
                if (queryLower.includes(trigger) && queryLower.length < 15) {
                    // Short/ambiguous query  ask for clarification
                    showClarificationPersistent(clarification);
                    return;
                }
            }

            // Find matching response
            let responseKey = 'default';
            let matched = false;

            if (queryLower.includes('fresh') || queryLower.includes('kibble') || queryLower.includes('why fresh')) {
                responseKey = 'fresh';
                matched = true;
            } else if (queryLower.includes('human-grade') || queryLower.includes('human grade')) {
                responseKey = 'human_grade';
                matched = true;
            } else if (queryLower.includes('cost') || queryLower.includes('price') || queryLower.includes('how much') || queryLower.includes('expensive')) {
                responseKey = 'cost';
                matched = true;
            } else if (queryLower.includes('ingredient') || queryLower.includes('recipe')) {
                responseKey = 'ingredients';
                matched = true;
            } else if (queryLower.includes('shipping') || queryLower.includes('delivery') || queryLower.includes('how do shipments')) {
                responseKey = 'shipping_how';
                matched = true;
            } else if (queryLower.includes('puppy') || queryLower.includes('puppies') || queryLower.includes('senior') || queryLower.includes('age')) {
                responseKey = 'puppy';
                matched = true;
            } else if (queryLower.includes('cancel') || queryLower.includes('pause') || queryLower.includes('stop')) {
                responseKey = 'cancel';
                matched = true;
            } else if (queryLower.includes('pancreatitis')) {
                responseKey = 'panc_info';
                matched = true;
            } else if (queryLower.includes('homemade') || queryLower.includes('home made') || queryLower.includes('make my own')) {
                responseKey = 'homemade';
                matched = true;
            } else if (queryLower.includes('healthy') || queryLower.includes('good food')) {
                responseKey = 'healthy';
                matched = true;
            // Payment failed scenario questions
            } else if (queryLower.includes('update') && queryLower.includes('payment')) {
                responseKey = 'update_payment';
                matched = true;
            } else if (queryLower.includes('why') && (queryLower.includes('payment') && queryLower.includes('fail'))) {
                responseKey = 'why_payment_failed';
                matched = true;
            } else if (queryLower.includes('delivery') && queryLower.includes('paused')) {
                responseKey = 'delivery_paused';
                matched = true;
            // Recent pause scenario questions
            } else if (queryLower.includes('resume') && (queryLower.includes('subscription') || queryLower.includes('delivery') || queryLower.includes('deliveries'))) {
                responseKey = 'resume_subscription';
                matched = true;
            } else if (queryLower.includes('adjust') && queryLower.includes('schedule')) {
                responseKey = 'adjust_schedule';
                matched = true;
            } else if (queryLower.includes('change') && (queryLower.includes('plan') || queryLower.includes('my plan'))) {
                responseKey = 'change_plan';
                matched = true;
            // New customer scenario questions
            } else if (queryLower.includes('transition') || (queryLower.includes('switch') && queryLower.includes('food'))) {
                responseKey = 'transition_tips';
                matched = true;
            } else if (queryLower.includes('storage') || queryLower.includes('store') || queryLower.includes('freezer') || queryLower.includes('fridge')) {
                responseKey = 'storage';
                matched = true;
            } else if (queryLower.includes('what to expect') || queryLower.includes('first box') || queryLower.includes('first order')) {
                responseKey = 'what_to_expect';
                matched = true;
            // Plan page scenario questions
            } else if (queryLower.includes('change') && queryLower.includes('recipe')) {
                responseKey = 'change_recipe';
                matched = true;
            } else if (queryLower.includes('adjust') && queryLower.includes('portion')) {
                responseKey = 'adjust_portions';
                matched = true;
            } else if (queryLower.includes('add') && (queryLower.includes('dog') || queryLower.includes('another dog'))) {
                responseKey = 'add_dog';
                matched = true;
            // Get Started page scenario questions
            } else if (queryLower.includes('how much') && (queryLower.includes('cost') || queryLower.includes('does it') || !queryLower.includes('food'))) {
                responseKey = 'how_much';
                matched = true;
            } else if (queryLower.includes('quiz') && queryLower.includes('ask')) {
                responseKey = 'quiz_questions';
                matched = true;
            } else if (queryLower.includes('compare') || queryLower.includes('other brands') || queryLower.includes('vs')) {
                responseKey = 'compare_brands';
                matched = true;
            // Default thought starter questions
            } else if (queryLower.includes('new to fresh') || queryLower.includes('what should i know')) {
                responseKey = 'new_to_fresh';
                matched = true;
            } else if (queryLower.includes('worth') && queryLower.includes('cost')) {
                responseKey = 'worth_the_cost';
                matched = true;
            } else if (queryLower.includes('what\'s actually in') || queryLower.includes('whats actually in')) {
                responseKey = 'whats_in_it';
                matched = true;
            } else if (queryLower.includes('allerg')) {
                responseKey = 'allergies';
                matched = true;
            }

            showResponsePersistent(responseKey, matched);
        }

        // Show clarification options (persistent version)
        function showClarificationPersistent(clarification) {
            const thread = document.getElementById('faqThread');

            setTimeout(() => {
                const clarifyMsg = document.createElement('div');
                clarifyMsg.className = 'faq-message--clarify visible';

                let optionsHtml = '';
                clarification.options.forEach((opt, i) => {
                    optionsHtml += `<button class="faq-clarify__option" onclick="handleClarificationChoicePersistent('${opt.response}', '${opt.label.replace(/'/g, "\\'")}', this.parentElement.parentElement)">${opt.label}</button>`;
                });

                clarifyMsg.innerHTML = `
                    <p class="faq-clarify__question">${clarification.question}</p>
                    <div class="faq-clarify__options">${optionsHtml}</div>
                `;

                thread.appendChild(clarifyMsg);
                scrollToBottom();
                document.getElementById('inputHint').textContent = 'Or type to clarify...';
            }, 300);
        }

        // Handle clarification choice (persistent version)
        function handleClarificationChoicePersistent(responseKey, choiceLabel, clarifyElement) {
            // Fade out clarification options
            clarifyElement.style.opacity = '0.5';
            clarifyElement.style.pointerEvents = 'none';

            // Add choice as user message
            const thread = document.getElementById('faqThread');
            const choiceMsg = document.createElement('div');
            choiceMsg.className = 'faq-message--user visible';
            choiceMsg.textContent = choiceLabel;
            thread.appendChild(choiceMsg);
            scrollToBottom();

            // Show appropriate response
            setTimeout(() => {
                showResponsePersistent(responseKey, true);
            }, 200);
        }

        // Show response (persistent version)
        function showResponsePersistent(responseKey, matched) {
            const response = conversationalResponses[responseKey] || conversationalResponses.default;
            const thread = document.getElementById('faqThread');

            setTimeout(() => {
                const responseMsg = document.createElement('div');
                responseMsg.className = 'faq-message--response visible';

                let followUpHtml = '';
                if (response.followUp) {
                    const followUpId = 'followup-' + Date.now();
                    followUpHtml = `
                        <div class="faq-followup" id="${followUpId}">
                            <p class="faq-followup__question">${response.followUp.question}</p>
                            <div class="faq-followup__options">
                                <button class="faq-followup__btn faq-followup__btn--primary" onclick="handleFollowUpYes('${followUpId}', '${response.followUp.videoUrl}')">Yes, show me</button>
                                <button class="faq-followup__btn" onclick="handleFollowUpNo('${followUpId}')">No thanks</button>
                            </div>
                        </div>
                    `;
                }

                let ctaHtml = '';
                if (!response.escalate && !response.followUp && !response.productCard) {
                    ctaHtml = `<div class="faq-message__cta"><a href="get-started-wireframe.html" class="faq-message__cta-link">Get started  50% off your first box </a></div>`;
                }

                responseMsg.innerHTML = response.answer + followUpHtml + ctaHtml;
                thread.appendChild(responseMsg);
                scrollToBottom();

                // If escalation needed, show handoff
                if (response.escalate) {
                    showEscalationPersistent();
                } else {
                    document.getElementById('inputHint').textContent = 'Ask another question';
                }

                // If product card, show it as a subsequent message
                if (response.productCard) {
                    setTimeout(() => {
                        showProductCard(response.productCard);
                    }, 600);
                }
            }, 300);
        }

        // Show product card as a subsequent message
        function showProductCard(product) {
            const thread = document.getElementById('faqThread');

            const productMsg = document.createElement('div');
            productMsg.className = 'faq-message--response visible';
            productMsg.innerHTML = `
                <p>You might be interested in this:</p>
                <div class="faq-product-card">
                    <div class="faq-product-card__image">DIY PRODUCT</div>
                    <div class="faq-product-card__content">
                        <h4 class="faq-product-card__title">${product.title}</h4>
                        <p class="faq-product-card__description">${product.description}</p>
                        <a href="${product.ctaUrl}" class="faq-product-card__cta">${product.ctaText}</a>
                    </div>
                </div>
            `;
            thread.appendChild(productMsg);
            scrollToBottom();
        }

        // Handle follow-up "Yes" response
        function handleFollowUpYes(followUpId, videoUrl) {
            const followUpEl = document.getElementById(followUpId);
            followUpEl.classList.add('answered');

            const thread = document.getElementById('faqThread');

            // Add user's "yes" as a message
            const userMsg = document.createElement('div');
            userMsg.className = 'faq-message--user visible';
            userMsg.textContent = 'Yes, show me';
            thread.appendChild(userMsg);
            scrollToBottom();

            // Show video response after a brief delay
            setTimeout(() => {
                const videoMsg = document.createElement('div');
                videoMsg.className = 'faq-message--response visible';
                videoMsg.innerHTML = `
                    <p>Here's a quick breakdown:</p>
                    <div class="faq-video-embed">
                        <iframe
                            src="${videoUrl}"
                            title="Video explanation"
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                            allowfullscreen>
                        </iframe>
                    </div>
                    <div class="faq-message__cta"><a href="get-started-wireframe.html" class="faq-message__cta-link">Get started  50% off your first box </a></div>
                `;
                thread.appendChild(videoMsg);
                scrollToBottom();
            }, 300);
        }

        // Handle follow-up "No" response
        function handleFollowUpNo(followUpId) {
            const followUpEl = document.getElementById(followUpId);
            followUpEl.classList.add('answered');

            const thread = document.getElementById('faqThread');

            // Add user's "no thanks" as a message
            const userMsg = document.createElement('div');
            userMsg.className = 'faq-message--user visible';
            userMsg.textContent = 'No thanks';
            thread.appendChild(userMsg);
            scrollToBottom();

            // Show acknowledgment and CTA
            setTimeout(() => {
                const ackMsg = document.createElement('div');
                ackMsg.className = 'faq-message--response visible';
                ackMsg.innerHTML = `
                    <p>No problem! Let me know if you have any other questions.</p>
                    <div class="faq-message__cta"><a href="get-started-wireframe.html" class="faq-message__cta-link">Get started  50% off your first box </a></div>
                `;
                thread.appendChild(ackMsg);
                scrollToBottom();
            }, 300);
        }

        // Show escalation flow (persistent version)
        function showEscalation(query) {
            const thread = document.getElementById('faqThread');

            setTimeout(() => {
                const responseMsg = document.createElement('div');
                responseMsg.className = 'faq-message--response visible';
                responseMsg.innerHTML = `<p>Let me connect you with someone who can help with this.</p>`;
                thread.appendChild(responseMsg);
                scrollToBottom();
            }, 300);

            showEscalationPersistent();
        }

        // Show handoff and agent message (persistent version)
        function showEscalationPersistent() {
            const thread = document.getElementById('faqThread');

            // Show handoff message
            setTimeout(() => {
                const handoffMsg = document.createElement('div');
                handoffMsg.className = 'faq-message--handoff visible';
                handoffMsg.textContent = 'Got it  a customer experience agent is going to take over from here.';
                thread.appendChild(handoffMsg);
                scrollToBottom();
            }, 600);

            // Show agent message
            setTimeout(() => {
                const agentMsg = document.createElement('div');
                agentMsg.className = 'faq-message--agent visible';
                agentMsg.innerHTML = `
                    <div class="faq-agent-avatar">P</div>
                    <div class="faq-agent-bubble">
                        <div class="faq-agent-name">Patty from The Farmer's Dog</div>
                        <div>Hey there!  I'm Patty from The Farmer's Dog. I'd love to help you with your question about "<strong>${currentQuery}</strong>". What's going on?</div>
                    </div>
                `;
                thread.appendChild(agentMsg);
                scrollToBottom();
                document.getElementById('inputHint').textContent = 'Type your reply...';
            }, 1500);
        }

        // Legacy functions kept for backwards compatibility
        function showClarification(clarification) { showClarificationPersistent(clarification); }
        function handleClarificationChoice(responseKey, choiceLabel) { handleClarificationChoicePersistent(responseKey, choiceLabel, null); }
        function showResponse(responseKey, matched) { showResponsePersistent(responseKey, matched); }
        function showEscalationAfterResponse() { showEscalationPersistent(); }

        // Scroll to bottom of conversation
        function scrollToBottom() {
            const scrollArea = document.getElementById('scrollArea');
            setTimeout(() => {
                scrollArea.scrollTo({
                    top: scrollArea.scrollHeight,
                    behavior: 'smooth'
                });
            }, 100);
        }

        // Hide welcome message when conversation starts
        function hideWelcome() {
            const welcome = document.getElementById('faqWelcome');
            if (welcome) {
                welcome.style.display = 'none';
            }
        }

        // Add a new message pair to the conversation (persistent history)
        function addMessagePair(userText, responseHtml, showCta = true, escalate = false) {
            const thread = document.getElementById('faqThread');

            // Create user message
            const userMsg = document.createElement('div');
            userMsg.className = 'faq-message--user visible';
            userMsg.textContent = userText;
            thread.appendChild(userMsg);

            // Create response message
            const responseMsg = document.createElement('div');
            responseMsg.className = 'faq-message--response visible';
            responseMsg.innerHTML = responseHtml;

            if (showCta && !escalate) {
                const ctaDiv = document.createElement('div');
                ctaDiv.className = 'faq-message__cta';
                ctaDiv.innerHTML = '<a href="get-started-wireframe.html" class="faq-message__cta-link">Get started  50% off your first box </a>';
                responseMsg.appendChild(ctaDiv);
            }

            thread.appendChild(responseMsg);
            scrollToBottom();

            return { userMsg, responseMsg };
        }

        // Handle sidebar question clicks
        function askSidebarQuestion(question) {
            currentQuery = question;
            hideWelcome();

            // Find matching response
            let responseKey = 'default';
            const queryLower = question.toLowerCase();

            if (queryLower.includes('kibble')) {
                responseKey = 'fresh';
            } else if (queryLower.includes('human-grade')) {
                responseKey = 'human_grade';
            } else if (queryLower.includes('healthy')) {
                responseKey = 'healthy';
            } else if (queryLower.includes('expensive') || queryLower.includes('cost')) {
                responseKey = 'cost';
            } else if (queryLower.includes('homemade')) {
                responseKey = 'homemade';
            }

            // Add user message
            const thread = document.getElementById('faqThread');
            const userMsg = document.createElement('div');
            userMsg.className = 'faq-message--user visible';
            userMsg.textContent = question;
            thread.appendChild(userMsg);
            scrollToBottom();

            // Show response (this handles follow-ups properly)
            showResponsePersistent(responseKey, true);
        }

        // Trigger agent handoff from sidebar
        function triggerAgentHandoff() {
            currentQuery = "Talk to your team";
            hideWelcome();

            // Add user message
            const thread = document.getElementById('faqThread');
            const userMsg = document.createElement('div');
            userMsg.className = 'faq-message--user visible';
            userMsg.textContent = "I'd like to talk to someone";
            thread.appendChild(userMsg);

            scrollToBottom();

            // Show handoff
            setTimeout(() => {
                const handoffMsg = document.createElement('div');
                handoffMsg.className = 'faq-message--handoff visible';
                handoffMsg.textContent = "Got it  a customer experience agent is going to take over from here.";
                thread.appendChild(handoffMsg);
                scrollToBottom();
            }, 400);

            // Show agent
            setTimeout(() => {
                const agentMsg = document.createElement('div');
                agentMsg.className = 'faq-message--agent visible';
                agentMsg.innerHTML = `
                    <div class="faq-agent-avatar">P</div>
                    <div class="faq-agent-bubble">
                        <div class="faq-agent-name">Patty from The Farmer's Dog</div>
                        <div>Hey there!  I'm Patty. How can I help you today?</div>
                    </div>
                `;
                thread.appendChild(agentMsg);
                scrollToBottom();
                document.getElementById('inputHint').textContent = 'Type your reply...';
            }, 1200);
        }

        // Add additional sidebar responses
        conversationalResponses['human_grade'] = {
            answer: `<p>Human-grade means the food is made with ingredients that meet FDA and USDA standards for human consumption, produced in facilities that follow the same safety protocols as human food production.</p>
<p>Most pet food is made with "feed-grade" ingredients not approved for people  things like meat by-products, rendered fats, and lower quality proteins that wouldn't pass inspection for your grocery store.</p>`,
            followUp: {
                question: "Want to see a quick video that breaks this down?",
                yesAction: "showVideo",
                videoUrl: "https://www.youtube.com/embed/QkxvhG_n51Q"
            }
        };

        conversationalResponses['healthy'] = {
            answer: `<p>Look for a few key things when evaluating any dog food:</p>
<p><strong>Transparency:</strong> Can you recognize the ingredients? Are they listed clearly, or hidden behind vague terms?</p>
<p><strong>Expertise:</strong> Is it formulated by board-certified veterinary nutritionists (not just "developed with vets")?</p>
<p><strong>Evidence:</strong> Are there peer-reviewed studies backing the health claims, or just marketing?</p>`
        };

        conversationalResponses['homemade'] = {
            answer: `<p>You can make homemade dog food, but it's harder than it looks.</p>
<p>Studies show that most homemade dog food recipes  even vet-recommended ones from books and websites  are nutritionally incomplete. Getting the right balance of vitamins, minerals, and macros for your specific dog requires careful formulation that changes as your dog ages.</p>
<p>If you want the benefits of fresh food without the nutritional guesswork, that's where we come in.</p>`,
            productCard: {
                title: "DIY Nutrient Mix",
                description: "Love cooking for your dog? Our vet-formulated nutrient mix makes it easy to create balanced, complete meals at home.",
                ctaText: "Learn more",
                ctaUrl: "#"
            }
        };

        // Payment failed scenario responses
        conversationalResponses['update_payment'] = {
            answer: `<p>Updating your payment method takes just a minute.</p>
<p>Head to your account settings, click on "Payment Method," and you can add a new card or update your existing one. Your next delivery will process once your payment is updated.</p>
<p>If you're having trouble, our support team can help  just reply here or give us a call.</p>`
        };

        conversationalResponses['why_payment_failed'] = {
            answer: `<p>Payment failures usually happen for a few common reasons:</p>
<ul style="margin: 1rem 0; padding-left: 1.5rem;">
<li>Your card expired or the number changed</li>
<li>Your bank flagged the charge (happens with new subscriptions)</li>
<li>Insufficient funds at the time of processing</li>
</ul>
<p>The quickest fix is usually to update your payment method in your account settings. If everything looks correct on your end, your bank can usually clear things up with a quick call.</p>`
        };

        conversationalResponses['delivery_paused'] = {
            answer: `<p>When a payment doesn't go through, we automatically pause your deliveries so you're not charged unexpectedly later.</p>
<p>Once you update your payment method, your deliveries will resume on their normal schedule. If you need to adjust your next delivery date, you can do that from your account too.</p>`
        };

        // Recent pause scenario responses
        conversationalResponses['resume_subscription'] = {
            answer: `<p>Welcome back! Resuming is easy.</p>
<p>Just head to your account and click "Resume Deliveries." You can pick your next delivery date, and we'll have fresh food on its way to you.</p>
<p>Your dog's plan is saved exactly as you left it  same recipes, same portions.</p>`
        };

        conversationalResponses['adjust_schedule'] = {
            answer: `<p>You can adjust your delivery schedule anytime from your account.</p>
<p>Change your delivery frequency (weekly, every 2 weeks, etc.), skip individual deliveries, or pick specific delivery dates that work better for you. We're flexible because life is unpredictable.</p>`
        };

        conversationalResponses['change_plan'] = {
            answer: `<p>Life changes, and your dog's food can too.</p>
<p>From your account, you can update your dog's weight, activity level, or health goals  and we'll recalculate the perfect portions. You can also swap recipes if your pup is ready for something new.</p>
<p>Changes take effect on your next delivery.</p>`
        };

        // New customer scenario responses
        conversationalResponses['transition_tips'] = {
            answer: `<p>Transitioning to fresh food is usually smooth, but a gradual switch helps.</p>
<p>We recommend mixing a little of our food with their current food, then gradually increasing the ratio over 7-10 days. Most dogs take to it immediately  the bigger challenge is getting them to slow down!</p>
<p>Your first box includes a transition guide with day-by-day instructions.</p>`
        };

        conversationalResponses['storage'] = {
            answer: `<p>Our food stays fresh in your freezer for months, and in your fridge for up to 4 days once thawed.</p>
<p>Each delivery is pre-portioned into daily packs, so you just move a few days' worth to the fridge at a time. No scooping, no mess, no guessing.</p>
<p>The packs are designed to stack efficiently  most customers find they take up less freezer space than they expected.</p>`
        };

        conversationalResponses['what_to_expect'] = {
            answer: `<p>Here's what happens after you order:</p>
<ul style="margin: 1rem 0; padding-left: 1.5rem;">
<li><strong>Your first box ships fast</strong>  usually within a few days, packed with dry ice to stay frozen</li>
<li><strong>Inside:</strong> pre-portioned daily packs, a feeding guide, and transition instructions</li>
<li><strong>Ongoing deliveries</strong> arrive on a schedule you control, always with fresh food ready to serve</li>
</ul>
<p>You'll get tracking info and reminders before each delivery. And you can adjust, pause, or cancel anytime from your account.</p>`
        };

        // Plan page scenario responses
        conversationalResponses['change_recipe'] = {
            answer: `<p>Absolutely  you can change recipes anytime from your account.</p>
<p>We offer several recipes, and some dogs do great rotating between them for variety. If your dog has specific dietary needs, our team can help you choose the best fit.</p>
<p>Recipe changes take effect on your next delivery.</p>`
        };

        conversationalResponses['adjust_portions'] = {
            answer: `<p>Portions are calculated based on your dog's profile  weight, age, activity level, and body condition.</p>
<p>If your dog is gaining or losing weight unexpectedly, you can adjust the daily calories in your account. Or update their profile info and we'll recalculate automatically.</p>
<p>Not sure what's right? Our team is happy to help fine-tune portions.</p>`
        };

        conversationalResponses['add_dog'] = {
            answer: `<p>Multi-dog household? We've got you covered.</p>
<p>You can add another dog to your account anytime. Each dog gets their own customized plan based on their unique needs, and everything ships together in one delivery.</p>
<p>Head to your account and click "Add a Dog" to get started.</p>`
        };

        // Get Started page scenario responses
        conversationalResponses['how_much'] = {
            answer: `<p>Pricing depends on your dog's size and caloric needs  smaller dogs cost less, larger dogs cost more.</p>
<p>Most customers pay between $2-12 per day. The quiz will give you an exact price for your dog before you commit to anything.</p>
<p>That includes free shipping, and you can adjust, pause, or cancel anytime.</p>`
        };

        conversationalResponses['quiz_questions'] = {
            answer: `<p>The quiz takes about 2 minutes and asks about:</p>
<ul style="margin: 1rem 0; padding-left: 1.5rem;">
<li>Your dog's basics (name, age, breed, weight)</li>
<li>Activity level and body condition</li>
<li>Any health concerns or allergies</li>
<li>Current diet and eating habits</li>
</ul>
<p>Based on your answers, we calculate the exact portions and recommend recipes that fit your dog's needs. No commitment until you see your plan and price.</p>`
        };

        conversationalResponses['compare_brands'] = {
            answer: `<p>We're often compared to other fresh food brands, and here's what makes us different:</p>
<ul style="margin: 1rem 0; padding-left: 1.5rem;">
<li><strong>True human-grade:</strong> Made in USDA-inspected facilities (not just "human-grade ingredients")</li>
<li><strong>Vet-developed recipes:</strong> Formulated by board-certified nutritionists</li>
<li><strong>Personalized portions:</strong> Calculated for your specific dog, not just their weight</li>
</ul>
<p>We're happy to answer specific questions about how we compare to any brand you're considering.</p>`
        };

        // Default "thought starter" responses
        conversationalResponses['new_to_fresh'] = {
            answer: `<p>Welcome! Fresh dog food is exactly what it sounds like  real, whole ingredients gently cooked and delivered to your door.</p>
<p>Unlike kibble (which is cooked at extreme temperatures and heavily processed), fresh food keeps more nutrients intact. Many pet parents notice shinier coats, better digestion, and more energy within the first few weeks.</p>
<p>The transition is usually easy  most dogs take to it immediately. We include a simple transition guide with your first box.</p>`
        };

        conversationalResponses['worth_the_cost'] = {
            answer: `<p>It's a fair question. Fresh food typically costs more than kibble  but many customers find the value goes beyond the bowl.</p>
<p>Plans range from about $29/day depending on your dog's size. For context, that's often less than a daily coffee.</p>
<p>What customers tell us: fewer vet visits for digestive issues and allergies, less waste (because dogs absorb more nutrients), and the peace of mind that comes from knowing exactly what's in the bowl.</p>`
        };

        conversationalResponses['whats_in_it'] = {
            answer: `<p>Real, recognizable ingredients  the kind you'd find in your own kitchen.</p>
<p>Our recipes use USDA human-grade meat (beef, chicken, turkey, or pork), fresh vegetables like sweet potatoes and leafy greens, and gentle cooking to preserve nutrients.</p>
<p>No fillers, no by-products, no artificial preservatives. Every recipe is formulated by board-certified veterinary nutritionists to be complete and balanced.</p>`
        };

        conversationalResponses['allergies'] = {
            answer: `<p>You're in the right place  allergies are one of the top reasons people switch to fresh food.</p>
<p>Many "allergies" are actually reactions to the fillers, additives, or low-quality proteins in processed food. Our limited-ingredient recipes make it easier to identify and avoid triggers.</p>
<p>When you build your plan, you can tell us about your dog's sensitivities and we'll recommend recipes that work. And if something isn't right, our team is here to help adjust.</p>`
        };

        // Clear conversation (keeps input intact) - NOW DEPRECATED for persistent mode
        function clearConversation() {
            // In persistent mode, we don't clear - messages stay in history
            // This function is kept for backwards compatibility but does nothing
        }

        // Reset conversation (full reset including input)
        function resetConversation() {
            // Clear all messages from thread
            const thread = document.getElementById('faqThread');
            thread.innerHTML = '';

            // Show welcome again
            const welcome = document.getElementById('faqWelcome');
            if (welcome) {
                welcome.style.display = 'block';
            }

            document.getElementById('faqInput').value = '';
            document.getElementById('inputHint').textContent = 'Press Enter to ask';
            currentQuery = '';
            document.getElementById('faqInput').focus();
        }

        // Toggle accordion
        function toggleAccordion(el) {
            // Close other open accordions (optional - comment out for multi-open)
            document.querySelectorAll('.faq-accordion.open').forEach(acc => {
                if (acc !== el) acc.classList.remove('open');
            });
            el.classList.toggle('open');
        }
    </script>
</body>
</html>
